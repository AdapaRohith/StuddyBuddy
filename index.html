<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyBuddy - Dashboard</title>
    
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous">
    
    <style>
        
        
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            overflow-x: hidden;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #2d1b69 100%) !important;
            background-attachment: fixed !important;
            min-height: 100vh !important;
        }
        
        
        .mobile-nav-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #2d1b69 100%);
            background-attachment: fixed;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        
        @supports not (backdrop-filter: blur(12px)) {
            .mobile-nav-overlay {
                background: linear-gradient(135deg, rgba(15, 15, 35, 0.95) 0%, rgba(26, 26, 62, 0.95) 50%, rgba(45, 27, 105, 0.95) 100%);
            }
        }
        
        
        .mobile-nav-overlay::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.3) 0%, rgba(26, 26, 62, 0.2) 50%, rgba(45, 27, 105, 0.3) 100%);
            z-index: -1;
        }
        
        .mobile-nav-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .mobile-nav-menu {
            position: fixed;
            top: 0;
            right: -320px;
            width: 300px;
            height: 100vh;
            background: linear-gradient(180deg, #1a1a3e 0%, #2d1b69 100%);
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.3);
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            z-index: 10000;
        }
        
        .mobile-nav-overlay.active .mobile-nav-menu {
            right: 0;
        }
        
        .mobile-nav-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .mobile-nav-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #ffffff;
        }
        
        .mobile-nav-close {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background 0.2s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .mobile-nav-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .mobile-nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .mobile-nav-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .mobile-nav-link {
            display: flex;
            align-items: center;
            padding: 18px 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.2s ease;
            gap: 15px;
            min-height: 60px;
        }
        
        .mobile-nav-link:hover,
        .mobile-nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transform: translateX(5px);
        }
        
        .mobile-nav-link i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
            color: #667eea;
        }
        
        .mobile-nav-link span {
            font-size: 1rem;
            font-weight: 500;
        }
        
        
        .mobile-auth-section {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
        }
        
        .mobile-auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .mobile-auth-btn {
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 48px;
        }
        
        .mobile-auth-btn.login {
            background: transparent;
            color: #ffffff;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .mobile-auth-btn.login:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .mobile-auth-btn.signup {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
        }
        
        .mobile-auth-btn.signup:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            transform: translateY(-2px);
        }
        
        
        
        
        @media (max-width: 992px) {
            .main-nav .nav-list {
                display: none !important;
            }
            
            .nav-toggle {
                display: block !important;
                background: none;
                border: none;
                color: #ffffff;
                font-size: 1.5rem;
                cursor: pointer;
                padding: 12px;
                border-radius: 8px;
                transition: all 0.2s ease;
                width: 48px;
                height: 48px;
                display: flex !important;
                align-items: center;
                justify-content: center;
            }
            
            .nav-toggle:hover {
                background: rgba(255, 255, 255, 0.1);
                transform: scale(1.1);
            }
            
            .nav-toggle.active {
                background: rgba(255, 255, 255, 0.15);
            }
            
            .mobile-nav-overlay {
                display: block;
            }
            
            
            .site-header {
                flex-wrap: wrap;
                gap: 1rem;
                padding: 1rem 1.5rem;
            }
            
            .logo {
                order: 1;
            }
            
            .main-nav {
                order: 3;
                margin-left: auto;
            }
            
            .auth-section,
            .user-section {
                order: 2;
                margin-left: auto;
            }
            
            .slogan {
                order: 4;
                width: 100%;
                text-align: center;
                margin: 0;
            }
        }
        
        
        @media (max-width: 768px) {
            .dashboard-content {
                display: flex !important;
                flex-direction: column !important;
                gap: 1.5rem !important;
                padding: 1rem !important;
            }
            
            .sidebar-left,
            .sidebar-right {
                width: 100% !important;
                order: 2;
            }
            
            .main-content {
                order: 1;
                width: 100% !important;
            }
            
            
            .card {
                padding: 1.2rem !important;
                margin-bottom: 1rem !important;
            }
            
            .card h3 {
                font-size: 1.2rem !important;
            }
            
            
            .task-item {
                padding: 15px !important;
                min-height: 60px !important;
                display: flex !important;
                align-items: center !important;
            }
            
            .task-item label {
                font-size: 1rem !important;
                line-height: 1.4 !important;
            }
            
            
            .resource-item {
                padding: 15px !important;
                min-height: 60px !important;
            }
            
            
            .btn,
            .btn-add-task,
            .btn-feature {
                min-height: 48px !important;
                padding: 12px 20px !important;
                font-size: 1rem !important;
            }
        }
        
        
        @media (max-width: 480px) {
            .site-header {
                padding: 0.8rem 1rem;
            }
            
            .logo h1 {
                font-size: 1.4rem !important;
            }
            
            .slogan {
                font-size: 0.85rem !important;
            }
            
            .auth-section {
                flex-direction: column !important;
                gap: 8px !important;
                width: 100% !important;
            }
            
            .btn-auth {
                width: 100% !important;
                justify-content: center !important;
                padding: 12px 16px !important;
            }
            
            .dashboard-content {
                padding: 0.5rem !important;
            }
            
            .card {
                padding: 1rem !important;
                border-radius: 8px !important;
            }
            
            
            .task-item {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 10px !important;
                text-align: left !important;
            }
            
            .task-item input[type="checkbox"] {
                margin-right: 10px !important;
                transform: scale(1.3) !important;
            }
            
            .close-btn {
                align-self: flex-end !important;
                margin-top: 8px !important;
            }
            
            
            .resource-item {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 12px !important;
                text-align: left !important;
            }
            
            .file-info {
                width: 100% !important;
            }

            .feature-header {
                flex-direction: column !important;
                gap: 10px !important;
                margin-bottom: 15px !important;
            }
            
            .feature-header i {
                font-size: 2rem !important;
            }
            
            .btn-feature {
                width: 100% !important;
                padding: 15px !important;
                justify-content: center !important;
            }
            
            
            .call-buttons {
                flex-direction: column !important;
                gap: 12px !important;
            }
            
            .call-button-item {
                width: 100% !important;
                padding: 15px !important;
                justify-content: center !important;
            }
            
            .btn-video-call,
            .btn-audio-call {
                width: 100% !important;
                padding: 12px !important;
            }
            
            
            body {
                font-size: 14px !important;
            }
            
            h2 {
                font-size: 1.3rem !important;
            }
            
            h3 {
                font-size: 1.1rem !important;
            }
            
            
            input[type="text"],
            input[type="email"],
            input[type="password"],
            select,
            textarea {
                padding: 12px !important;
                font-size: 16px !important; 
                border-radius: 8px !important;
                width: 100% !important;
            }
        }
        
        
        @media (max-width: 360px) {
            .mobile-nav-menu {
                width: 280px;
            }
            
            .site-header {
                padding: 0.5rem;
            }
            
            .dashboard-content {
                padding: 0.25rem !important;
            }
        }
        
        
        .mobile-nav-overlay,
        .mobile-nav-menu {
            will-change: transform, opacity;
        }
        
        
        @media (prefers-reduced-motion: reduce) {
            .mobile-nav-overlay,
            .mobile-nav-menu,
            .mobile-nav-link {
                transition: none !important;
            }
        }
        
        
        @media (prefers-contrast: high) {
            .mobile-nav-menu {
                border: 2px solid #ffffff;
            }
            
            .mobile-nav-link {
                border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            }
        }

        
        .button-clicked {
            transition: transform 0.15s ease !important;
        }

        
        .download-modal,
        .progress-detail-modal,
        .tracker-detail-modal {
            background: linear-gradient(135deg, #1a1a3e 0%, #2d1b69 100%);
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .download-modal,
        .modal-overlay.active .progress-detail-modal,
        .modal-overlay.active .tracker-detail-modal {
            transform: scale(1);
        }

        .download-header,
        .progress-detail-header,
        .tracker-detail-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .download-header h3,
        .progress-detail-header h3,
        .tracker-detail-header h3 {
            color: white;
            margin: 0;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .download-content,
        .progress-detail-content,
        .tracker-detail-content {
            padding: 30px;
        }

        .file-preview {
            text-align: center;
            margin-bottom: 25px;
        }

        .file-icon {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            background: rgba(102, 126, 234, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: #667eea;
            margin: 0 auto 15px;
        }

        .file-preview h4 {
            color: white;
            margin: 0 0 8px 0;
            font-size: 1.1rem;
        }

        .file-details {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin: 0;
        }

        .download-progress {
            margin: 20px 0;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            height: 12px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            text-align: center;
        }

        .download-actions,
        .progress-actions,
        .tracker-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .large-progress-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                #667eea 0deg,
                #667eea calc(var(--progress, 0) * 3.6deg),
                rgba(255, 255, 255, 0.1) calc(var(--progress, 0) * 3.6deg),
                rgba(255, 255, 255, 0.1) 360deg
            );
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            position: relative;
        }

        .large-progress-circle::before {
            content: '';
            position: absolute;
            inset: 12px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1a1a3e 0%, #2d1b69 100%);
        }

        .large-progress-circle span {
            position: relative;
            z-index: 2;
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }

        .progress-stats {
            margin-bottom: 25px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-item i {
            color: #667eea;
            font-size: 1.3rem;
            width: 20px;
        }

        .stat-item div {
            flex: 1;
        }

        .stat-label {
            display: block;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .stat-value {
            display: block;
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .tracker-info {
            margin-bottom: 25px;
        }

        .tracker-info h4 {
            color: white;
            margin: 0 0 15px 0;
            font-size: 1.2rem;
        }

        .tracker-details {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 20px;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
            color: rgba(255, 255, 255, 0.8);
        }

        .detail-item i {
            color: #667eea;
            width: 18px;
        }

        
        .study-analytics-section {
            background: linear-gradient(145deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px;
            margin-bottom: 20px;
            max-width: 100%;
            box-sizing: border-box;
        }

        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .analytics-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .btn-refresh-analytics {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-refresh-analytics:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(180deg);
        }

        .analytics-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 100%;
            overflow: hidden;
        }

        
        .analytics-metric {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            backdrop-filter: blur(10px);
        }

        .metric-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
        }

        .metric-icon.streak {
            background: linear-gradient(45deg, #ff6b35, #ff9068);
        }

        .metric-icon.focus {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }

        .metric-icon.progress {
            background: linear-gradient(45deg, #ffecd2, #fcb69f);
        }

        .metric-info {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            line-height: 1;
        }

        .metric-label {
            font-size: 12px;
            opacity: 0.8;
            margin: 2px 0;
        }

        .metric-trend {
            font-size: 11px;
            font-weight: 500;
        }

        .metric-trend.up {
            color: #4ade80;
        }

        .metric-trend.down {
            color: #f87171;
        }

        .metric-trend.neutral {
            color: #fbbf24;
        }



        
        .subject-performance {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            backdrop-filter: blur(10px);
        }

        .subject-performance h4 {
            margin: 0 0 15px 0;
            font-size: 14px;
            font-weight: 600;
        }

        .performance-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .performance-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subject-name {
            font-size: 12px;
            font-weight: 500;
            min-width: 80px;
        }

        .performance-bar {
            flex-grow: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .performance-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #22c55e);
            width: var(--performance, 0%);
            border-radius: 4px;
            transition: width 1s ease;
        }

        .performance-score {
            font-size: 12px;
            font-weight: 600;
            min-width: 35px;
            text-align: right;
        }

        
        .sample-tasks-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tasks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .tasks-header h4 {
            margin: 0;
            color: #e2e8f0;
            font-size: 16px;
            font-weight: 600;
        }

        .add-task-btn {
            background: linear-gradient(45deg, #10b981, #059669) !important;
            border: 2px solid #10b981 !important;
            color: white !important;
            padding: 12px 20px !important;
            height: auto !important;
            border-radius: 8px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 8px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4) !important;
            font-size: 16px !important;
            font-weight: 700 !important;
            min-width: 120px !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
            z-index: 1000 !important;
            position: relative !important;
        }

        .add-task-btn:hover {
            transform: translateY(-3px) scale(1.05) !important;
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.6) !important;
            background: linear-gradient(45deg, #059669, #047857) !important;
            border-color: #059669 !important;
        }

        
        .tasks-header {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            margin-bottom: 20px !important;
            padding: 15px !important;
            background: rgba(255, 255, 255, 0.05) !important;
            border-radius: 10px !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        .tasks-header h3, .tasks-header h4 {
            margin: 0 !important;
            font-size: 24px !important;
            font-weight: 600 !important;
            color: white !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
        }

        .tasks-header {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            padding: 20px !important;
            background: rgba(255,255,255,0.1) !important;
            border-radius: 10px !important;
            margin-bottom: 20px !important;
        }

        
        .btn-add-task {
            background: linear-gradient(45deg, #10b981, #059669) !important;
            border: 2px solid #10b981 !important;
            color: white !important;
            padding: 15px 25px !important;
            font-size: 18px !important;
            font-weight: bold !important;
            border-radius: 10px !important;
            cursor: pointer !important;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4) !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
            transition: all 0.3s ease !important;
            z-index: 1000 !important;
            position: relative !important;
            min-width: 140px !important;
            justify-content: center !important;
        }

        .btn-add-task:hover {
            transform: translateY(-3px) scale(1.05) !important;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.6) !important;
            background: linear-gradient(45deg, #059669, #047857) !important;
            border-color: #059669 !important;
        }

        .btn-add-task .task-icon {
            font-size: 16px !important;
        }

        .btn-add-task .task-btn-text {
            font-weight: 800 !important;
            font-size: 16px !important;
        }

        
        .interactive-add-task-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .interactive-add-task-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border: none;
            color: white;
            padding: 18px 35px;
            border-radius: 15px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
            min-width: 200px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .btn-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            z-index: 2;
        }

        .btn-icon-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-main-icon {
            font-size: 22px;
            animation: iconBounce 2s ease-in-out infinite;
        }

        .btn-sparkles {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .sparkle {
            position: absolute;
            font-size: 12px;
            opacity: 0;
            animation: sparkleFloat 3s ease-in-out infinite;
        }

        .sparkle-1 {
            animation-delay: 0s;
            top: -25px;
            left: -20px;
        }

        .sparkle-2 {
            animation-delay: 1s;
            top: -30px;
            right: -15px;
        }

        .sparkle-3 {
            animation-delay: 2s;
            bottom: -25px;
            left: -25px;
        }

        .btn-text {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .btn-pulse-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            border: 2px solid rgba(255, 255, 255, 0.6);
            border-radius: 15px;
            transform: translate(-50%, -50%) scale(1);
            opacity: 0;
            pointer-events: none;
        }

        .btn-tooltip {
            position: absolute;
            bottom: -45px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .btn-tooltip::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 5px solid rgba(0, 0, 0, 0.8);
        }

        
        .interactive-add-task-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 50%, #e65aa8 100%);
        }

        .interactive-add-task-btn:hover .btn-pulse-ring {
            animation: pulseRing 0.6s ease-out;
        }

        .interactive-add-task-btn:hover .btn-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .interactive-add-task-btn:hover .btn-main-icon {
            animation: iconSpin 0.6s ease-in-out;
        }

        
        .interactive-add-task-btn:active {
            transform: translateY(-1px) scale(1.02);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }



        
        @keyframes iconBounce {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-3px) rotate(5deg); }
            50% { transform: translateY(0px) rotate(0deg); }
            75% { transform: translateY(-1px) rotate(-3deg); }
        }

        @keyframes sparkleFloat {
            0%, 100% { 
                opacity: 0; 
                transform: translateY(0px) rotate(0deg) scale(0.5); 
            }
            50% { 
                opacity: 1; 
                transform: translateY(-15px) rotate(180deg) scale(1); 
            }
        }

        @keyframes pulseRing {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.6;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.3);
                opacity: 0;
            }
        }

        @keyframes iconSpin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }



        
        @media (max-width: 768px) {
            
            .tasks-header {
                flex-direction: column !important;
                gap: 15px !important;
                padding: 15px !important;
            }
            
            .tasks-header h3 {
                font-size: 20px !important;
                text-align: center;
            }
            
            
            .interactive-add-task-container {
                width: 100%;
                display: flex;
                justify-content: center;
            }
            
            .interactive-add-task-btn {
                padding: 12px 20px;
                min-width: 140px;
                width: 100%;
                max-width: 280px;
            }
            
            .btn-text {
                font-size: 14px;
            }
            
            .btn-main-icon {
                font-size: 16px;
            }
            
            
            .btn-sparkles {
                display: none; 
            }
            
            
            .quick-add-container {
                margin: 10px 0;
            }
            
            .quick-add-form {
                padding: 15px;
                margin: 0 10px;
            }
            
            .quick-add-input-wrapper input {
                font-size: 16px; 
                padding: 12px;
            }
            
            .quick-add-buttons {
                margin-top: 15px;
            }
            
            .quick-btn {
                width: 44px;
                height: 44px; 
                font-size: 16px;
            }
            
            .quick-add-hint {
                font-size: 12px;
                text-align: center;
                margin-top: 10px;
            }
            
            
            .task-item {
                padding: 12px;
                margin-bottom: 10px;
            }
            
            .task-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .task-title {
                font-size: 14px;
                line-height: 1.4;
            }
            
            .task-meta {
                font-size: 11px;
                gap: 10px;
                margin-top: 5px;
            }
            
            .task-actions {
                opacity: 1; 
                margin-top: 10px;
            }
            
            .task-edit, .task-delete {
                padding: 8px;
                font-size: 14px;
                min-width: 40px;
                min-height: 40px;
            }
            
            
            .tasks-summary {
                flex-direction: column;
                gap: 8px;
                text-align: center;
                font-size: 12px;
            }
            
            
            .tasks-list {
                margin: 0 -5px; 
            }
        }

        
        .bonus-tools-card, .motivation-card, .quick-links-card, 
        .weather-widget, .achievements-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .bonus-header, .motivation-header, .links-header, 
        .widget-header, .achievements-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .bonus-header h3, .motivation-header h3, .links-header h3, 
        .widget-header h3, .achievements-header h3 {
            color: white;
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        .bonus-tools {
            display: grid;
            gap: 10px;
        }

        .bonus-btn {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .bonus-btn:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.4) 0%, rgba(118, 75, 162, 0.4) 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .bonus-btn i {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .bonus-btn span {
            font-weight: 600;
            font-size: 14px;
        }

        .bonus-btn small {
            opacity: 0.8;
            font-size: 12px;
        }

        .quote-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .quote-text {
            color: white;
            font-style: italic;
            margin: 0 0 10px 0;
            font-size: 14px;
            line-height: 1.4;
        }

        .quote-author {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            font-weight: 500;
        }

        .motivation-stats {
            display: flex;
            gap: 10px;
        }

        .stat-badge {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .refresh-quote-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .refresh-quote-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(180deg);
        }

        .links-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .quick-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .quick-link:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
            color: #667eea;
        }

        .quick-link i {
            font-size: 16px;
            width: 20px;
        }

        .environment-info {
            text-align: center;
        }

        .current-time {
            margin-bottom: 15px;
        }

        .time-display {
            display: block;
            color: white;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .date-display {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .study-tip {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            color: white;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .achievements-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .achievement-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .achievement-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .achievement-icon {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .achievement-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .achievement-title {
            color: white;
            font-weight: 600;
            font-size: 13px;
        }

        .achievement-desc {
            color: rgba(255, 255, 255, 0.7);
            font-size: 11px;
        }

        .achievement-time {
            color: rgba(255, 255, 255, 0.6);
            font-size: 10px;
            font-weight: 500;
        }

        .tasks-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }

        .task-item.completed {
            opacity: 0.7;
            background: rgba(74, 222, 128, 0.1);
            border-color: rgba(74, 222, 128, 0.3);
        }

        .task-item.urgent {
            border-color: rgba(248, 113, 113, 0.5);
            background: rgba(248, 113, 113, 0.1);
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .task-item.completed .task-checkbox {
            background: #4ade80;
            border-radius: 6px;
            color: white;
        }

        .checkbox-circle {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-circle:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .task-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .task-title {
            color: #e2e8f0;
            font-weight: 500;
            font-size: 14px;
            line-height: 1.3;
        }

        .task-item.completed .task-title {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .task-meta {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 12px;
            color: rgba(226, 232, 240, 0.7);
        }

        .task-meta i {
            font-size: 10px;
            margin-right: 4px;
        }

        .task-actions {
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .task-item:hover .task-actions {
            opacity: 1;
        }

        .task-edit, .task-delete {
            background: none;
            border: none;
            color: rgba(226, 232, 240, 0.6);
            cursor: pointer;
            padding: 6px;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .task-edit:hover {
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
        }

        .task-delete {
            color: rgba(248, 113, 113, 0.8) !important;
        }

        .task-delete:hover {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171 !important;
            transform: scale(1.2);
        }

        .tasks-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
            color: rgba(226, 232, 240, 0.8);
        }

        .tasks-count {
            font-weight: 600;
        }

        .tasks-progress {
            color: #4ade80;
            font-weight: 500;
        }

        
        .recent-achievements {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            backdrop-filter: blur(10px);
        }

        .recent-achievements h4 {
            margin: 0 0 15px 0;
            font-size: 14px;
            font-weight: 600;
        }

        .achievements-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .achievement-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .achievement-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .achievement-info {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .achievement-title {
            font-size: 12px;
            font-weight: 600;
            line-height: 1;
        }

        .achievement-desc {
            font-size: 10px;
            opacity: 0.8;
            margin-top: 2px;
        }

        .achievement-time {
            font-size: 10px;
            opacity: 0.6;
            font-weight: 500;
        }

        
        .analytics-actions {
            display: flex;
            gap: 10px;
        }

        .btn-analytics {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 12px 8px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .btn-analytics:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        .btn-analytics i {
            font-size: 12px;
        }

        
        .navigation-preloader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 15, 35, 0.9);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10002;
        }

        .preloader-content {
            text-align: center;
            color: white;
        }

        .preloader-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        
        .dropdown-menu {
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px) scale(0.95);
            transition: all 0.2s ease;
        }

        .dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        .dropdown-toggle.active {
            background: rgba(255, 255, 255, 0.1);
        }

        
        .resource-item {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .resource-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        
        .progress-circle {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .progress-circle:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        
        .tracker-item {
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 15px;
            border-radius: 8px;
        }

        .tracker-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        
        @media (max-width: 768px) {
            .download-actions,
            .progress-actions,
            .tracker-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .call-buttons {
                gap: 8px;
            }
            
            .stat-item {
                padding: 12px 0;
            }
        }

    </style>
</head>
<body>

    <div class="site-container">
        <header class="site-header">
            <div class="logo">
                <i class="fa-solid fa-user-graduate"></i> <h1>StudyBuddy</h1>
            </div>
            <p class="slogan">Collaborate. Learn. Achieve.</p>
            
            
            <div class="auth-section" id="authSection">
                <button class="btn-auth btn-login" id="loginBtn">
                    <i class="fa-solid fa-sign-in-alt"></i>
                    <span>Sign In</span>
                </button>
                <button class="btn-auth btn-signup" id="signupBtn">
                    <i class="fa-solid fa-rocket"></i>
                    <span>Get Started</span>
                </button>
            </div>

            
            <div class="user-section" id="userSection" style="display: none;">
                <div class="user-profile">
                    <div class="user-avatar default-avatar">
                        <i class="fa-solid fa-user"></i>
                    </div>
                    <div class="user-info">
                        <span class="user-name">Your Name</span>
                        <span class="user-email">Your University</span>
                    </div>
                    <div class="user-dropdown">
                        <button class="dropdown-toggle" id="userDropdown">
                            <i class="fa-solid fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="dropdownMenu">
                            <a href="profile.html" class="dropdown-item">
                                <i class="fa-solid fa-user"></i> My Profile
                            </a>
                            <a href="#" class="dropdown-item">
                                <i class="fa-solid fa-cog"></i> Settings
                            </a>
                            <a href="#" class="dropdown-item" id="notificationSettings">
                                <i class="fa-solid fa-bell"></i> Notifications
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item logout-item" id="logoutBtn">
                                <i class="fa-solid fa-sign-out-alt"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            
            <nav class="main-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link active">
                            <i class="fa-solid fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="html/groups.html" class="nav-link">
                            <i class="fa-solid fa-users"></i>
                            <span>Groups</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="html/resources.html" class="nav-link">
                            <i class="fa-solid fa-folder"></i>
                            <span>Resources</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="html/schedule.html" class="nav-link">
                            <i class="fa-solid fa-calendar"></i>
                            <span>Schedule</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="html/profile.html" class="nav-link">
                            <i class="fa-solid fa-user"></i>
                            <span>Profile</span>
                        </a>
                    </li>
                </ul>
                <button class="nav-toggle" id="navToggle">
                    <i class="fa-solid fa-bars"></i>
                </button>
            </nav>
        </header>

        
        <div class="mobile-nav-overlay" id="mobileNavOverlay">
            <div class="mobile-nav-menu">
                <div class="mobile-nav-header">
                    <span class="mobile-nav-title">StudyBuddy Menu</span>
                    <button class="mobile-nav-close" id="mobileNavClose">
                        <i class="fa-solid fa-times"></i>
                    </button>
                </div>
                
                <ul class="mobile-nav-list">
                    <li class="mobile-nav-item">
                        <a href="index.html" class="mobile-nav-link active">
                            <i class="fa-solid fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="html/groups.html" class="mobile-nav-link">
                            <i class="fa-solid fa-users"></i>
                            <span>Groups</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="html/resources.html" class="mobile-nav-link">
                            <i class="fa-solid fa-folder"></i>
                            <span>Resources</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="html/schedule.html" class="mobile-nav-link">
                            <i class="fa-solid fa-calendar"></i>
                            <span>Schedule</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="html/profile.html" class="mobile-nav-link">
                            <i class="fa-solid fa-user"></i>
                            <span>Profile</span>
                        </a>
                    </li>
                </ul>
                
                <div class="mobile-auth-section" id="mobileAuthSection">
                    <div class="mobile-auth-buttons">
                        <button class="mobile-auth-btn login" id="mobileLoginBtn">
                            <i class="fa-solid fa-sign-in-alt"></i>
                            <span>Sign In</span>
                        </button>
                        <button class="mobile-auth-btn signup" id="mobileSignupBtn">
                            <i class="fa-solid fa-rocket"></i>
                            <span>Get Started</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <main class="dashboard">
            <div class="dashboard-content">

                <aside class="sidebar-left">
                    <h2>My Groups</h2>
                    <ul class="group-list" id="dashboardGroupList">
                        
                    </ul>
                </aside>

                <section class="main-content">
                    <h2>Group Dashboard</h2>

                    <div class="card task-card">
                        <div class="tasks-header">
                            <h3><i class="fa-solid fa-list-check"></i> Today's Tasks</h3>
                            <div class="interactive-add-task-container">
                                <button id="interactiveAddTaskBtn" class="interactive-add-task-btn" onclick="showInteractiveTaskCreator()">
                                    <div class="btn-content">
                                        <div class="btn-icon-container">
                                            <i class="fa-solid fa-plus btn-main-icon"></i>
                                            <div class="btn-sparkles">
                                                <span class="sparkle sparkle-1"></span>
                                                <span class="sparkle sparkle-2"></span>
                                                <span class="sparkle sparkle-3"></span>
                                            </div>
                                        </div>
                                        <span class="btn-text">ADD TASK</span>
                                        <div class="btn-pulse-ring"></div>
                                    </div>
                                    <div class="btn-tooltip">Click to create a new task with smart features!</div>
                                </button>
                            </div>
                        </div>
                        
                        
                        <div class="quick-add-container" id="quickAddContainer">
                            <div class="quick-add-form" id="quickAddForm">
                                <div class="quick-add-input-wrapper">
                                    <input type="text" id="quickTaskInput" placeholder="What needs to be done?" maxlength="100" autocomplete="off">
                                    <div class="input-underline"></div>
                                </div>
                                <div class="quick-add-buttons">
                                    <button class="quick-btn quick-save" id="quickSaveBtn" title="Save task">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                    <button class="quick-btn quick-cancel" id="quickCancelBtn" title="Cancel">
                                        <i class="fa-solid fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="quick-add-hint">
                                <span>Press Enter to save  Press Escape to cancel</span>
                            </div>
                        </div>
                        
                        <div class="tasks-list">
                            <div class="task-item completed">
                                <div class="task-checkbox">
                                    <i class="fa-solid fa-check"></i>
                                </div>
                                <div class="task-content">
                                    <span class="task-title">Complete Physics Assignment - Chapter 12</span>
                                    <span class="task-meta">
                                        <i class="fa-solid fa-clock"></i> 2:30 PM
                                        <i class="fa-solid fa-flag"></i> High Priority
                                    </span>
                                </div>
                                <div class="task-actions">
                                    <button class="task-edit"><i class="fa-solid fa-edit"></i></button>
                                    <button class="task-delete" onclick="deleteTask(this)"><i class="fa-solid fa-times"></i></button>
                                </div>
                            </div>

                            <div class="task-item">
                                <div class="task-checkbox">
                                    <div class="checkbox-circle"></div>
                                </div>
                                <div class="task-content">
                                    <span class="task-title">Review Mathematics Notes - Calculus</span>
                                    <span class="task-meta">
                                        <i class="fa-solid fa-clock"></i> 4:00 PM
                                        <i class="fa-solid fa-flag"></i> Medium Priority
                                    </span>
                                </div>
                                <div class="task-actions">
                                    <button class="task-edit"><i class="fa-solid fa-edit"></i></button>
                                    <button class="task-delete" onclick="deleteTask(this)"><i class="fa-solid fa-times"></i></button>
                                </div>
                            </div>

                            <div class="task-item urgent">
                                <div class="task-checkbox">
                                    <div class="checkbox-circle"></div>
                                </div>
                                <div class="task-content">
                                    <span class="task-title">Prepare Chemistry Lab Report</span>
                                    <span class="task-meta">
                                        <i class="fa-solid fa-clock"></i> 6:00 PM
                                        <i class="fa-solid fa-flag"></i> Urgent
                                    </span>
                                </div>
                                <div class="task-actions">
                                    <button class="task-edit"><i class="fa-solid fa-edit"></i></button>
                                    <button class="task-delete" onclick="deleteTask(this)"><i class="fa-solid fa-times"></i></button>
                                </div>
                            </div>

                            <div class="task-item">
                                <div class="task-checkbox">
                                    <div class="checkbox-circle"></div>
                                </div>
                                <div class="task-content">
                                    <span class="task-title">Study Group Meeting - Biology</span>
                                    <span class="task-meta">
                                        <i class="fa-solid fa-clock"></i> 8:00 PM
                                        <i class="fa-solid fa-flag"></i> Medium Priority
                                    </span>
                                </div>
                                <div class="task-actions">
                                    <button class="task-edit"><i class="fa-solid fa-edit"></i></button>
                                    <button class="task-delete" onclick="deleteTask(this)"><i class="fa-solid fa-times"></i></button>
                                </div>
                            </div>

                            <div class="task-item">
                                <div class="task-checkbox">
                                    <div class="checkbox-circle"></div>
                                </div>
                                <div class="task-content">
                                    <span class="task-title">Read Economics Chapter 5-6</span>
                                    <span class="task-meta">
                                        <i class="fa-solid fa-clock"></i> 9:30 PM
                                        <i class="fa-solid fa-flag"></i> Low Priority
                                    </span>
                                </div>
                                <div class="task-actions">
                                    <button class="task-edit"><i class="fa-solid fa-edit"></i></button>
                                    <button class="task-delete" onclick="deleteTask(this)"><i class="fa-solid fa-times"></i></button>
                                </div>
                            </div>
                        </div>
                        <div class="tasks-summary">
                            <span class="tasks-count">4 of 5 tasks remaining</span>
                            <span class="tasks-progress">20% completed today</span>
                        </div>
                    </div>

                    <div class="card resources-card">
                        <div class="resources-header">
                            <h3><i class="fa-solid fa-share-nodes"></i> Shared Resources</h3>
                            <button class="btn-add-resource" id="addResourceBtn" title="Add new resource">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                        <ul class="resource-list">
                            <li class="resource-item">
                                <div class="file-icon-wrapper">
                                    <i class="fa-solid fa-file-pdf pdf-icon"></i>
                                </div>
                                <div class="file-info">
                                    <span class="file-name">Fluid_Dynamics.pdf</span>
                                    <span class="file-details">2.4 MB  Added 2 hours ago</span>
                                </div>
                                <div class="resource-actions">
                                    <div class="progress-circle" style="--progress: 75;">
                                        <span>75%</span>
                                    </div>
                                    <button class="resource-btn download-btn" title="Download">
                                        <i class="fa-solid fa-download"></i>
                                    </button>
                                    <button class="resource-btn share-btn" title="Share">
                                        <i class="fa-solid fa-share"></i>
                                    </button>
                                </div>
                            </li>
                            <li class="resource-item">
                                <div class="file-icon-wrapper">
                                    <i class="fa-brands fa-python py-icon"></i>
                                </div>
                                <div class="file-info">
                                    <span class="file-name">Heat_Sink_Simulation.py</span>
                                    <span class="file-details">5.2 KB  Added 1 day ago</span>
                                </div>
                                <div class="resource-actions">
                                    <div class="progress-circle" style="--progress: 100;">
                                        <span></span>
                                    </div>
                                    <button class="resource-btn download-btn" title="Download">
                                        <i class="fa-solid fa-download"></i>
                                    </button>
                                    <button class="resource-btn share-btn" title="Share">
                                        <i class="fa-solid fa-share"></i>
                                    </button>
                                </div>
                            </li>
                            <li class="resource-item">
                                <div class="file-icon-wrapper">
                                    <i class="fa-solid fa-file-word doc-icon"></i>
                                </div>
                                <div class="file-info">
                                    <span class="file-name">Study_Notes_Ch5.docx</span>
                                    <span class="file-details">1.8 MB  Added 3 days ago</span>
                                </div>
                                <div class="resource-actions">
                                    <div class="progress-circle" style="--progress: 50;">
                                        <span>50%</span>
                                    </div>
                                    <button class="resource-btn download-btn" title="Download">
                                        <i class="fa-solid fa-download"></i>
                                    </button>
                                    <button class="resource-btn share-btn" title="Share">
                                        <i class="fa-solid fa-share"></i>
                                    </button>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="card quick-stats-card">
                        <div class="quick-stats-header">
                            <h3><i class="fa-solid fa-gauge-high"></i> Quick Stats</h3>
                            <button class="refresh-stats-btn" id="refreshStatsBtn" title="Refresh Statistics">
                                <i class="fa-solid fa-rotate-right"></i>
                            </button>
                        </div>

                        
                        <div class="stats-grid">
                            <div class="stat-box study-time">
                                <div class="stat-icon">
                                    <i class="fa-solid fa-clock"></i>
                                </div>
                                <div class="stat-content">
                                    <span class="stat-value" id="weeklyHours">12.5h</span>
                                    <span class="stat-label">This Week</span>
                                    <div class="stat-progress">
                                        <div class="progress-bar" style="--progress: 78%;"></div>
                                        <span class="progress-text">78% of goal</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-box streak">
                                <div class="stat-icon">
                                    <i class="fa-solid fa-fire"></i>
                                </div>
                                <div class="stat-content">
                                    <span class="stat-value" id="studyStreak">7</span>
                                    <span class="stat-label">Day Streak</span>
                                    <div class="streak-indicator">
                                        <span class="streak-emoji"></span>
                                        <span class="streak-text">On fire!</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-box productivity">
                                <div class="stat-icon">
                                    <i class="fa-solid fa-chart-line"></i>
                                </div>
                                <div class="stat-content">
                                    <span class="stat-value" id="productivityScore">87%</span>
                                    <span class="stat-label">Productivity</span>
                                    <div class="productivity-trend">
                                        <i class="fa-solid fa-arrow-up trend-up"></i>
                                        <span class="trend-text">+5% vs last week</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-box completion">
                                <div class="stat-icon">
                                    <i class="fa-solid fa-check-circle"></i>
                                </div>
                                <div class="stat-content">
                                    <span class="stat-value" id="tasksCompleted">24/30</span>
                                    <span class="stat-label">Tasks Done</span>
                                    <div class="completion-rate">
                                        <span class="rate-text">80% completion rate</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        
                        <div class="quick-actions">
                            <button class="quick-action-btn study-btn" id="quickStudyBtn">
                                <i class="fa-solid fa-book-open"></i>
                                <span>Quick Study</span>
                            </button>
                            <button class="quick-action-btn break-btn" id="quickBreakBtn">
                                <i class="fa-solid fa-coffee"></i>
                                <span>Take Break</span>
                            </button>
                            <button class="quick-action-btn review-btn" id="quickReviewBtn">
                                <i class="fa-solid fa-repeat"></i>
                                <span>Review Notes</span>
                            </button>
                        </div>

                        
                        <div class="live-updates">
                            <h4><i class="fa-solid fa-bell"></i> Live Updates</h4>
                            <div class="update-list" id="liveUpdatesList">
                                <div class="update-item">
                                    <div class="update-dot active"></div>
                                    <div class="update-content">
                                        <span class="update-text">Study session completed - 45 minutes</span>
                                        <span class="update-time">2 minutes ago</span>
                                    </div>
                                </div>
                                <div class="update-item">
                                    <div class="update-dot"></div>
                                    <div class="update-content">
                                        <span class="update-text">New resource shared in Fluid Dynamics</span>
                                        <span class="update-time">15 minutes ago</span>
                                    </div>
                                </div>
                                <div class="update-item">
                                    <div class="update-dot"></div>
                                    <div class="update-content">
                                        <span class="update-text">Upcoming: Virtual Meetup - Tuesday 7 PM</span>
                                        <span class="update-time">1 hour</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        
                        <div class="daily-goals">
                            <h4><i class="fa-solid fa-target"></i> Today's Goals</h4>
                            <div class="goals-list">
                                <div class="goal-item completed">
                                    <i class="fa-solid fa-check"></i>
                                    <span>Complete Chapter 5 review</span>
                                </div>
                                <div class="goal-item in-progress">
                                    <i class="fa-solid fa-clock"></i>
                                    <span>Study for 3 hours</span>
                                    <div class="goal-progress">
                                        <div class="goal-bar" style="--goal-width: 67%;"></div>
                                    </div>
                                </div>
                                <div class="goal-item pending">
                                    <i class="fa-regular fa-circle"></i>
                                    <span>Join study group meeting</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    
                    <div class="card realtime-tracker-card">
                        <div class="tracker-header">
                            <h3><i class="fa-solid fa-chart-line"></i> Real-Time Study Tracker</h3>
                            <div class="tracker-controls">
                                <button class="tracker-btn start-btn" id="startStudyBtn" title="Start Study Session">
                                    <i class="fa-solid fa-play"></i>
                                </button>
                                <button class="tracker-btn pause-btn" id="pauseStudyBtn" title="Pause Session" style="display: none;">
                                    <i class="fa-solid fa-pause"></i>
                                </button>
                                <button class="tracker-btn stop-btn" id="stopStudyBtn" title="Stop Session" style="display: none;">
                                    <i class="fa-solid fa-stop"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="current-session">
                            <div class="session-timer">
                                <div class="timer-display">
                                    <span class="time-value" id="currentTime">00:00:00</span>
                                    <span class="session-label">Current Session</span>
                                </div>
                                <div class="session-subject">
                                    <input type="text" id="sessionSubject" placeholder="What are you studying?" maxlength="50">
                                </div>
                            </div>
                        </div>

                        <div class="daily-progress">
                            <h4><i class="fa-solid fa-calendar-day"></i> Today's Progress</h4>
                            <div class="progress-stats">
                                <div class="stat-item">
                                    <span class="stat-value" id="todayTotal">2h 35m</span>
                                    <span class="stat-label">Total Time</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="sessionCount">3</span>
                                    <span class="stat-label">Sessions</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="focusScore">85%</span>
                                    <span class="stat-label">Focus Score</span>
                                </div>
                            </div>
                            
                            <div class="daily-goal">
                                <div class="goal-info">
                                    <span>Daily Goal: 4h</span>
                                    <span class="goal-percentage" id="goalPercentage">64%</span>
                                </div>
                                <div class="goal-progress">
                                    <div class="goal-bar" style="--goal-progress: 64%;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="study-subjects">
                            <h4><i class="fa-solid fa-book"></i> Subject Breakdown</h4>
                            <div class="subject-list">
                                <div class="subject-item">
                                    <div class="subject-info">
                                        <span class="subject-name">Fluid Dynamics</span>
                                        <span class="subject-time">1h 25m</span>
                                    </div>
                                    <div class="subject-bar" style="--subject-width: 55%;"></div>
                                </div>
                                <div class="subject-item">
                                    <div class="subject-info">
                                        <span class="subject-name">Python Programming</span>
                                        <span class="subject-time">45m</span>
                                    </div>
                                    <div class="subject-bar" style="--subject-width: 29%;"></div>
                                </div>
                                <div class="subject-item">
                                    <div class="subject-info">
                                        <span class="subject-name">Mathematics</span>
                                        <span class="subject-time">25m</span>
                                    </div>
                                    <div class="subject-bar" style="--subject-width: 16%;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="weekly-overview">
                            <h4><i class="fa-solid fa-chart-column"></i> This Week</h4>
                            <div class="week-chart">
                                <div class="day-column" style="--day-height: 75%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Mon</span>
                                    <span class="day-time">3h</span>
                                </div>
                                <div class="day-column" style="--day-height: 60%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Tue</span>
                                    <span class="day-time">2.4h</span>
                                </div>
                                <div class="day-column active" style="--day-height: 64%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Wed</span>
                                    <span class="day-time">2.6h</span>
                                </div>
                                <div class="day-column future" style="--day-height: 0%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Thu</span>
                                    <span class="day-time">0h</span>
                                </div>
                                <div class="day-column future" style="--day-height: 0%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Fri</span>
                                    <span class="day-time">0h</span>
                                </div>
                                <div class="day-column future" style="--day-height: 0%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Sat</span>
                                    <span class="day-time">0h</span>
                                </div>
                                <div class="day-column future" style="--day-height: 0%;">
                                    <div class="day-bar"></div>
                                    <span class="day-label">Sun</span>
                                    <span class="day-time">0h</span>
                                </div>
                            </div>
                        </div>


                    </div>
                </section>

                <aside class="sidebar-right">
                    <h2>Bonus Features</h2>

                    
                    <div class="card bonus-tools-card">
                        <div class="bonus-header">
                            <h3><i class="fa-solid fa-magic-wand-sparkles"></i> Quick Study Tools</h3>
                        </div>
                        <div class="bonus-tools">
                            <button class="bonus-btn timer-btn" onclick="startPomodoroTimer()">
                                <i class="fa-solid fa-clock"></i>
                                <span>Pomodoro Timer</span>
                                <small>25 min focus sessions</small>
                            </button>
                            <button class="bonus-btn notes-btn" onclick="openQuickNotes()">
                                <i class="fa-solid fa-sticky-note"></i>
                                <span>Quick Notes</span>
                                <small>Jot down ideas fast</small>
                            </button>
                            <button class="bonus-btn calculator-btn" onclick="openCalculator()">
                                <i class="fa-solid fa-calculator"></i>
                                <span>Calculator</span>
                                <small>Built-in math helper</small>
                            </button>
                            <button class="bonus-btn flashcards-btn" onclick="openFlashcards()">
                                <i class="fa-solid fa-layer-group"></i>
                                <span>Flashcards</span>
                                <small>Quick review cards</small>
                            </button>
                        </div>
                    </div>

                    
                    <div class="card motivation-card">
                        <div class="motivation-header">
                            <h3><i class="fa-solid fa-heart"></i> Daily Motivation</h3>
                            <button class="refresh-quote-btn" onclick="refreshQuote()">
                                <i class="fa-solid fa-refresh"></i>
                            </button>
                        </div>
                        <div class="quote-container">
                            <div class="daily-quote">
                                <p class="quote-text" id="motivationQuote">
                                    "Success is not final, failure is not fatal: it is the courage to continue that counts."
                                </p>
                                <span class="quote-author" id="quoteAuthor">- Winston Churchill</span>
                            </div>
                        </div>
                        <div class="motivation-stats">
                            <div class="stat-badge">
                                <i class="fa-solid fa-trophy"></i>
                                <span>Level 7 Scholar</span>
                            </div>
                            <div class="stat-badge">
                                <i class="fa-solid fa-fire"></i>
                                <span>7 Day Streak</span>
                            </div>
                        </div>
                    </div>

                    
                    <div class="card quick-links-card">
                        <div class="links-header">
                            <h3><i class="fa-solid fa-link"></i> Quick Links</h3>
                        </div>
                        <div class="links-list">
                            <a href="html/schedule.html" class="quick-link">
                                <i class="fa-solid fa-calendar-plus"></i>
                                <span>Study Planner</span>
                            </a>
                            <a href="html/profile.html" class="quick-link">
                                <i class="fa-solid fa-chart-line"></i>
                                <span>Progress Analytics</span>
                            </a>
                            <a href="html/resources.html" class="quick-link">
                                <i class="fa-solid fa-folder-open"></i>
                                <span>Resource Library</span>
                            </a>
                            <a href="html/groups.html" class="quick-link">
                                <i class="fa-solid fa-users"></i>
                                <span>Study Groups</span>
                            </a>
                        </div>
                    </div>

                    
                    <div class="card weather-widget">
                        <div class="widget-header">
                            <h3><i class="fa-solid fa-cloud-sun"></i> Study Environment</h3>
                        </div>
                        <div class="environment-info">
                            <div class="current-time">
                                <span class="time-display" id="currentTime">4:32 PM</span>
                                <span class="date-display" id="currentDate">Wednesday, Nov 6</span>
                            </div>
                            <div class="study-tip">
                                <i class="fa-solid fa-lightbulb"></i>
                                <span id="studyTip">Perfect time for a focused study session!</span>
                            </div>
                        </div>
                    </div>

                    
                    <div class="card achievements-card">
                        <div class="achievements-header">
                            <h3><i class="fa-solid fa-medal"></i> Recent Achievements</h3>
                        </div>
                        <div class="achievements-list">
                            <div class="achievement-item">
                                <div class="achievement-icon"></div>
                                <div class="achievement-info">
                                    <span class="achievement-title">Task Master</span>
                                    <span class="achievement-desc">Completed 10 tasks in one day</span>
                                </div>
                                <span class="achievement-time">Today</span>
                            </div>
                            <div class="achievement-item">
                                <div class="achievement-icon"></div>
                                <div class="achievement-info">
                                    <span class="achievement-title">Study Streak</span>
                                    <span class="achievement-desc">7 consecutive days of studying</span>
                                </div>
                                <span class="achievement-time">2 hours ago</span>
                            </div>
                            <div class="achievement-item">
                                <div class="achievement-icon"></div>
                                <div class="achievement-info">
                                    <span class="achievement-title">Focus Champion</span>
                                    <span class="achievement-desc">Maintained 90% focus score</span>
                                </div>
                                <span class="achievement-time">Yesterday</span>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </main>
    </div>

    
    <div class="modal-overlay" id="taskModal">
        <div class="task-modal-container">
            <div class="task-modal-header">
                <h3><i class="fa-solid fa-plus"></i> Add New Task</h3>
                <button class="close-modal" id="closeTaskModal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            
            <div class="task-modal-content">
                <form id="taskForm" class="task-form">
                    <div class="form-group">
                        <label for="taskTitle">Task Title</label>
                        <input type="text" id="taskTitle" name="taskTitle" placeholder="Enter your task..." required maxlength="100">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDescription">Description (Optional)</label>
                        <textarea id="taskDescription" name="taskDescription" placeholder="Add details about your task..." rows="3" maxlength="300"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskPriority">Priority</label>
                            <select id="taskPriority" name="taskPriority">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="taskDueDate">Due Date (Optional)</label>
                            <input type="date" id="taskDueDate" name="taskDueDate">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskCategory">Category</label>
                        <select id="taskCategory" name="taskCategory">
                            <option value="general">General</option>
                            <option value="study">Study</option>
                            <option value="project">Project</option>
                            <option value="exam">Exam</option>
                            <option value="assignment">Assignment</option>
                            <option value="meeting">Meeting</option>
                        </select>
                    </div>
                    
                    <div class="task-modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancelTaskBtn">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fa-solid fa-plus"></i> Add Task
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    
    <script defer src="js/api.js"></script>
    <script defer src="js/auth.js"></script>
    <script defer src="js/script.js"></script>
    
    <script>
        
        
        
        class MobileNavigation {
            constructor() {
                this.overlay = document.getElementById('mobileNavOverlay');
                this.toggle = document.getElementById('navToggle');
                this.close = document.getElementById('mobileNavClose');
                this.authSection = document.getElementById('mobileAuthSection');
                this.isOpen = false;
                
                this.init();
            }
            
            init() {
                
                if (this.toggle) {
                    this.toggle.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        this.toggleMenu();
                    });
                }
                
                
                if (this.close) {
                    this.close.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.closeMenu();
                    });
                }
                
                
                if (this.overlay) {
                    this.overlay.addEventListener('click', (e) => {
                        if (e.target === this.overlay) {
                            this.closeMenu();
                        }
                    });
                }
                
                
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.isOpen) {
                        this.closeMenu();
                    }
                });
                
                
                const mobileLoginBtn = document.getElementById('mobileLoginBtn');
                const mobileSignupBtn = document.getElementById('mobileSignupBtn');
                
                if (mobileLoginBtn) {
                    mobileLoginBtn.addEventListener('click', () => {
                        this.closeMenu();
                        
                        createAuthModal('login');
                    });
                }
                
                if (mobileSignupBtn) {
                    mobileSignupBtn.addEventListener('click', () => {
                        this.closeMenu();
                        
                        createAuthModal('register');
                    });
                }
                
                
                const navLinks = this.overlay?.querySelectorAll('.mobile-nav-link');
                navLinks?.forEach(link => {
                    link.addEventListener('click', () => {
                        this.closeMenu();
                    });
                });
            }
            
            toggleMenu() {
                if (this.isOpen) {
                    this.closeMenu();
                } else {
                    this.openMenu();
                }
            }
            
            openMenu() {
                if (!this.overlay) return;
                
                this.isOpen = true;
                this.overlay.classList.add('active');
                this.toggle?.classList.add('active');
                
                
                document.body.style.overflow = 'hidden';
                document.body.style.position = 'fixed';
                document.body.style.width = '100%';
                
                
                this.trapFocus();
            }
            
            closeMenu() {
                if (!this.overlay) return;
                
                this.isOpen = false;
                this.overlay.classList.remove('active');
                this.toggle?.classList.remove('active');
                
                
                document.body.style.overflow = '';
                document.body.style.position = '';
                document.body.style.width = '';
            }
            
            trapFocus() {
                const focusableElements = this.overlay?.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                
                if (!focusableElements?.length) return;
                
                const firstFocusable = focusableElements[0];
                const lastFocusable = focusableElements[focusableElements.length - 1];
                
                firstFocusable.focus();
                
                const handleTabKey = (e) => {
                    if (e.key === 'Tab') {
                        if (e.shiftKey) {
                            if (document.activeElement === firstFocusable) {
                                e.preventDefault();
                                lastFocusable.focus();
                            }
                        } else {
                            if (document.activeElement === lastFocusable) {
                                e.preventDefault();
                                firstFocusable.focus();
                            }
                        }
                    }
                };
                
                document.addEventListener('keydown', handleTabKey);
                
                
                const removeTabListener = () => {
                    document.removeEventListener('keydown', handleTabKey);
                };
                
                this.overlay.addEventListener('transitionend', (e) => {
                    if (e.target === this.overlay && !this.isOpen) {
                        removeTabListener();
                    }
                }, { once: true });
            }
            
            updateAuthState(isAuthenticated) {
                if (this.authSection) {
                    this.authSection.style.display = isAuthenticated ? 'none' : 'block';
                }
            }
        }
        
        
        
        
        class TaskManager {
            constructor() {
                this.modal = document.getElementById('taskModal');
                this.openBtn = document.getElementById('addTaskBtn');
                this.closeBtn = document.getElementById('closeTaskModal');
                this.cancelBtn = document.getElementById('cancelTaskBtn');
                this.form = document.getElementById('taskForm');
                this.taskList = document.querySelector('.task-list');
                
                
                this.quickForm = document.getElementById('quickAddForm');
                this.quickInput = document.getElementById('quickTaskInput');
                this.quickSaveBtn = document.getElementById('quickSaveBtn');
                this.quickCancelBtn = document.getElementById('quickCancelBtn');
                
                this.tasks = this.loadTasks();
                this.isQuickFormVisible = false;
                
                this.init();
                this.renderTasks();
            }
            
            init() {
                
                if (this.openBtn) {
                    this.openBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.toggleQuickAdd();
                    });
                }
                
                
                const modalBtn = document.getElementById('modalTaskBtn');
                if (modalBtn) {
                    modalBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.openModal();
                    });
                }
                
                
                if (this.quickSaveBtn) {
                    this.quickSaveBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.saveQuickTask();
                    });
                }
                
                if (this.quickCancelBtn) {
                    this.quickCancelBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.hideQuickForm();
                    });
                }
                
                if (this.quickInput) {
                    this.quickInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            this.saveQuickTask();
                        } else if (e.key === 'Escape') {
                            e.preventDefault();
                            this.hideQuickForm();
                        }
                    });
                    
                    
                    this.quickInput.addEventListener('focus', () => {
                        this.quickInput.parentElement.style.transform = 'scale(1.02)';
                    });
                    
                    this.quickInput.addEventListener('blur', () => {
                        this.quickInput.parentElement.style.transform = 'scale(1)';
                    });
                }
                
                
                if (this.closeBtn) {
                    this.closeBtn.addEventListener('click', () => this.closeModal());
                }
                
                if (this.cancelBtn) {
                    this.cancelBtn.addEventListener('click', () => this.closeModal());
                }
                
                
                if (this.modal) {
                    this.modal.addEventListener('click', (e) => {
                        if (e.target === this.modal) {
                            this.closeModal();
                        }
                    });
                }
                
                
                this.bindTaskEvents();
                
                
                if (this.form) {
                    this.form.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.addTask();
                    });
                }
                
                
                const dueDateInput = document.getElementById('taskDueDate');
                if (dueDateInput) {
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    dueDateInput.value = tomorrow.toISOString().split('T')[0];
                }
            }
            
            openModal() {
                if (this.modal) {
                    this.modal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    
                    const firstInput = this.modal.querySelector('#taskTitle');
                    if (firstInput) {
                        setTimeout(() => firstInput.focus(), 300);
                    }
                }
            }
            
            closeModal() {
                if (this.modal) {
                    this.modal.classList.remove('active');
                    document.body.style.overflow = '';
                    
                    
                    if (this.form) {
                        this.form.reset();
                        
                        
                        const dueDateInput = document.getElementById('taskDueDate');
                        if (dueDateInput) {
                            const tomorrow = new Date();
                            tomorrow.setDate(tomorrow.getDate() + 1);
                            dueDateInput.value = tomorrow.toISOString().split('T')[0];
                        }
                    }
                }
            }
            
            
            toggleQuickAdd() {
                if (this.isQuickFormVisible) {
                    this.hideQuickForm();
                } else {
                    this.showQuickForm();
                }
            }
            
            showQuickForm() {
                if (this.quickForm && this.quickInput) {
                    
                    this.openBtn.classList.add('active');
                    
                    
                    this.quickForm.classList.add('show');
                    this.isQuickFormVisible = true;
                    
                    
                    setTimeout(() => {
                        this.quickInput.focus();
                        this.quickInput.style.transform = 'scale(1.02)';
                    }, 200);
                }
            }
            
            hideQuickForm() {
                if (this.quickForm && this.quickInput) {
                    
                    this.openBtn.classList.remove('active');
                    
                    
                    this.quickForm.classList.remove('show');
                    this.quickInput.value = '';
                    this.quickInput.style.transform = 'scale(1)';
                    this.isQuickFormVisible = false;
                    
                    
                    setTimeout(() => {
                        this.quickInput.blur();
                    }, 300);
                }
            }
            
            addRippleEffect(element) {
                
                return;
            }
            
            bindTaskEvents() {
                
                document.addEventListener('change', (e) => {
                    if (e.target.type === 'checkbox' && e.target.closest('.task-item')) {
                        this.toggleTaskCompletion(e.target);
                    }
                });
                
                
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('task-close-btn')) {
                        e.preventDefault();
                        this.removeTask(e.target);
                    }
                });
            }
            
            toggleTaskCompletion(checkbox) {
                const taskItem = checkbox.closest('.task-item');
                if (taskItem) {
                    taskItem.classList.toggle('completed', checkbox.checked);
                    
                    
                    taskItem.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        taskItem.style.transform = '';
                    }, 150);
                }
            }
            
            removeTask(closeBtn) {
                const taskItem = closeBtn.closest('.task-item');
                if (taskItem) {
                    
                    taskItem.style.transform = 'translateX(-100%)';
                    taskItem.style.opacity = '0';
                    
                    setTimeout(() => {
                        taskItem.remove();
                        this.showNotification('Task removed successfully', 'info');
                    }, 300);
                }
            }
            
            saveQuickTask() {
                if (!this.quickInput) return;
                
                const taskText = this.quickInput.value.trim();
                if (!taskText) {
                    this.showNotification('Please enter a task description', 'warning');
                    this.quickInput.focus();
                    return;
                }
                
                if (taskText.length > 100) {
                    this.showNotification('Task description is too long (max 100 characters)', 'warning');
                    return;
                }
                
                
                const taskId = 'task_' + Date.now();
                const taskItem = document.createElement('li');
                taskItem.className = 'task-item';
                taskItem.innerHTML = `
                    <div class="task-content">
                        <input type="checkbox" id="${taskId}">
                        <label for="${taskId}">${this.escapeHtml(taskText)}</label>
                    </div>
                    <button class="task-close-btn" title="Remove task">&times;</button>
                `;
                
                
                taskItem.style.opacity = '0';
                taskItem.style.transform = 'translateY(-20px)';
                
                
                const taskList = this.taskList;
                if (taskList) {
                    taskList.insertBefore(taskItem, taskList.firstChild);
                    
                    
                    setTimeout(() => {
                        taskItem.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                        taskItem.style.opacity = '1';
                        taskItem.style.transform = 'translateY(0)';
                    }, 10);
                }
                
                
                const task = {
                    id: taskId,
                    title: taskText,
                    description: '',
                    priority: 'medium',
                    dueDate: '',
                    category: 'general',
                    completed: false,
                    createdAt: new Date().toISOString()
                };
                
                this.tasks.unshift(task);
                this.saveTasks();
                this.hideQuickForm();
                
                this.showNotification('Task added successfully!', 'success');
                
                
                this.addCelebrationEffect();
            }
            
            escapeHtml(unsafe) {
                return unsafe
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }
            
            addCelebrationEffect() {
                
                const colors = ['#667eea', '#764ba2', '#10b981', '#f59e0b'];
                for (let i = 0; i < 6; i++) {
                    setTimeout(() => {
                        this.createParticle(colors[i % colors.length]);
                    }, i * 100);
                }
            }
            
            createParticle(color) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    width: 8px;
                    height: 8px;
                    background: ${color};
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 10000;
                    animation: particle-burst 0.8s ease-out forwards;
                `;
                
                const angle = Math.random() * Math.PI * 2;
                const velocity = 150 + Math.random() * 100;
                const x = Math.cos(angle) * velocity;
                const y = Math.sin(angle) * velocity;
                
                particle.style.setProperty('--x', x + 'px');
                particle.style.setProperty('--y', y + 'px');
                
                document.body.appendChild(particle);
                
                setTimeout(() => particle.remove(), 800);
            }
            
            addTask() {
                const formData = new FormData(this.form);
                const task = {
                    id: 'task_' + Date.now(),
                    title: formData.get('taskTitle'),
                    description: formData.get('taskDescription') || '',
                    priority: formData.get('taskPriority'),
                    dueDate: formData.get('taskDueDate'),
                    category: formData.get('taskCategory'),
                    completed: false,
                    createdAt: new Date().toISOString()
                };
                
                
                if (!task.title.trim()) {
                    this.showNotification('Please enter a task title', 'error');
                    return;
                }
                
                this.tasks.unshift(task); 
                this.saveTasks();
                this.renderTasks();
                this.closeModal();
                
                this.showNotification('Task added successfully!', 'success');
            }
            
            removeTask(taskId) {
                this.tasks = this.tasks.filter(task => task.id !== taskId);
                this.saveTasks();
                this.renderTasks();
                this.showNotification('Task removed', 'info');
            }
            
            toggleTask(taskId) {
                const task = this.tasks.find(task => task.id === taskId);
                if (task) {
                    task.completed = !task.completed;
                    task.completedAt = task.completed ? new Date().toISOString() : null;
                    this.saveTasks();
                    this.renderTasks();
                }
            }
            
            renderTasks() {
                if (!this.taskList) return;
                
                if (this.tasks.length === 0) {
                    this.taskList.innerHTML = `
                        <li class="task-item" style="justify-content: center; text-align: center; opacity: 0.6;">
                            <span>No tasks yet. Click ADD to create your first task!</span>
                        </li>
                    `;
                    return;
                }
                
                
                const sortedTasks = [...this.tasks].sort((a, b) => {
                    
                    if (a.completed !== b.completed) {
                        return a.completed ? 1 : -1;
                    }
                    
                    
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    const priorityDiff = priorityOrder[b.priority] - priorityOrder[a.priority];
                    if (priorityDiff !== 0) return priorityDiff;
                    
                    
                    if (a.dueDate && b.dueDate) {
                        return new Date(a.dueDate) - new Date(b.dueDate);
                    }
                    if (a.dueDate && !b.dueDate) return -1;
                    if (!a.dueDate && b.dueDate) return 1;
                    
                    return 0;
                });
                
                this.taskList.innerHTML = sortedTasks.map(task => `
                    <li class="task-item ${task.completed ? 'completed' : ''}" data-task-id="${task.id}">
                        <input type="checkbox" 
                               id="${task.id}" 
                               ${task.completed ? 'checked' : ''}
                               onchange="taskManager.toggleTask('${task.id}')">
                        <label for="${task.id}" title="${task.description || task.title}">
                            ${task.title}
                            ${task.dueDate ? `<br><small style="opacity: 0.7;">Due: ${this.formatDate(task.dueDate)}</small>` : ''}
                        </label>
                        <span class="task-priority ${task.priority}">${task.priority}</span>
                        <button class="close-btn" onclick="taskManager.removeTask('${task.id}')" title="Remove task"></button>
                    </li>
                `).join('');
            }
            
            formatDate(dateString) {
                const date = new Date(dateString);
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                if (date.toDateString() === today.toDateString()) {
                    return 'Today';
                } else if (date.toDateString() === tomorrow.toDateString()) {
                    return 'Tomorrow';
                } else {
                    return date.toLocaleDateString('en-US', { 
                        weekday: 'short', 
                        month: 'short', 
                        day: 'numeric' 
                    });
                }
            }
            
            loadTasks() {
                try {
                    const saved = localStorage.getItem('studyBuddyTasks');
                    return saved ? JSON.parse(saved) : [];
                } catch (e) {
                    console.error('Error loading tasks:', e);
                    return [];
                }
            }
            
            saveTasks() {
                try {
                    localStorage.setItem('studyBuddyTasks', JSON.stringify(this.tasks));
                } catch (e) {
                    console.error('Error saving tasks:', e);
                    this.showNotification('Error saving task', 'error');
                }
            }
            
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `task-notification ${type}`;
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                    z-index: 10001;
                    font-weight: 500;
                    transform: translateX(100%);
                    transition: transform 0.3s ease;
                    font-size: 0.9rem;
                `;
                
                notification.textContent = message;
                document.body.appendChild(notification);
                
                
                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                }, 100);
                
                
                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 2500);
            }
        }
        
        
        
        
        function initSmoothScrolling() {
            
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            
            let scrollToTopBtn = document.createElement('button');
            scrollToTopBtn.innerHTML = '<i class="fa-solid fa-chevron-up"></i>';
            scrollToTopBtn.className = 'scroll-to-top';
            scrollToTopBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
                cursor: pointer;
                opacity: 0;
                visibility: hidden;
                transform: translateY(100px);
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                z-index: 1000;
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
            `;
            
            document.body.appendChild(scrollToTopBtn);
            
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    scrollToTopBtn.style.opacity = '1';
                    scrollToTopBtn.style.visibility = 'visible';
                    scrollToTopBtn.style.transform = 'translateY(0)';
                } else {
                    scrollToTopBtn.style.opacity = '0';
                    scrollToTopBtn.style.visibility = 'hidden';
                    scrollToTopBtn.style.transform = 'translateY(100px)';
                }
            });
            
            
            scrollToTopBtn.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }
        
        
        
        
        function initPerformanceOptimizations() {
            
            const setVH = () => {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            };
            
            setVH();
            window.addEventListener('resize', setVH);
            window.addEventListener('orientationchange', setVH);
            
            
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                img.removeAttribute('data-src');
                            }
                            observer.unobserve(img);
                        }
                    });
                });
                
                
                document.querySelectorAll('img[data-src]').forEach(img => {
                    imageObserver.observe(img);
                });
            }
            
            
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    
                    window.dispatchEvent(new CustomEvent('debouncedResize'));
                }, 250);
            });
        }
        
        let mobileNav;
        
        
        function initializeAllButtons() {
            
            document.querySelectorAll('.resource-item').forEach(item => {
                item.addEventListener('click', function() {
                    addButtonClickEffect(this);
                    const fileName = this.querySelector('.file-name')?.textContent || 'file';
                    
                    
                    showDownloadModal(fileName);
                });
            });

            
            document.querySelectorAll('.progress-circle').forEach(circle => {
                circle.addEventListener('click', function() {
                    addButtonClickEffect(this);
                    showProgressDetails(this);
                });
            });

            
            document.querySelectorAll('.nav-link').forEach(link => {
                const originalHandler = link.onclick;
                link.addEventListener('click', function(e) {
                    if (this.getAttribute('href') !== '#') {
                        addButtonClickEffect(this);
                        showNavigationPreloader();
                    }
                });
            });

            
            const userDropdown = document.getElementById('userDropdown');
            const dropdownMenu = document.getElementById('dropdownMenu');
            
            if (userDropdown && dropdownMenu) {
                userDropdown.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    addButtonClickEffect(this);
                    
                    dropdownMenu.classList.toggle('show');
                    this.classList.toggle('active');
                });

                
                document.addEventListener('click', function(e) {
                    if (!userDropdown.contains(e.target) && !dropdownMenu.contains(e.target)) {
                        dropdownMenu.classList.remove('show');
                        userDropdown.classList.remove('active');
                    }
                });
            }

            
            document.querySelectorAll('.tracker-item').forEach(item => {
                item.addEventListener('click', function() {
                    addButtonClickEffect(this);
                    showTrackerDetails(this);
                });
            });

            
            initializeStudyAnalytics();
        }

        function addButtonClickEffect(element) {
            
            return;
        }

        function showDownloadModal(fileName) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.innerHTML = `
                <div class="download-modal">
                    <div class="download-header">
                        <h3><i class="fa-solid fa-download"></i> Download File</h3>
                        <button class="close-modal" onclick="this.closest('.modal-overlay').remove()">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    <div class="download-content">
                        <div class="file-preview">
                            <div class="file-icon">
                                <i class="fa-solid ${getFileIcon(fileName)}"></i>
                            </div>
                            <h4>${fileName}</h4>
                            <p class="file-details">Size: ${getRandomSize()}  Modified: ${getRandomDate()}</p>
                        </div>
                        <div class="download-progress" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <div class="progress-text">Downloading... <span class="progress-percent">0%</span></div>
                        </div>
                        <div class="download-actions">
                            <button class="btn btn-secondary" onclick="this.closest('.modal-overlay').remove()">
                                Cancel
                            </button>
                            <button class="btn btn-primary" onclick="startDownload(this)">
                                <i class="fa-solid fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function startDownload(btn) {
            const modal = btn.closest('.download-modal');
            const actions = modal.querySelector('.download-actions');
            const progress = modal.querySelector('.download-progress');
            const progressFill = modal.querySelector('.progress-fill');
            const progressPercent = modal.querySelector('.progress-percent');
            
            actions.style.display = 'none';
            progress.style.display = 'block';
            
            let percent = 0;
            const interval = setInterval(() => {
                percent += Math.random() * 15 + 5;
                if (percent >= 100) {
                    percent = 100;
                    clearInterval(interval);
                    
                    setTimeout(() => {
                        modal.remove();
                        showNotification('Download completed!', 'success');
                    }, 500);
                }
                
                progressFill.style.width = percent + '%';
                progressPercent.textContent = Math.round(percent) + '%';
            }, 200);
        }

        function getFileIcon(fileName) {
            const ext = fileName.split('.').pop().toLowerCase();
            const icons = {
                'pdf': 'fa-file-pdf',
                'py': 'fa-file-code',
                'js': 'fa-file-code',
                'html': 'fa-file-code',
                'css': 'fa-file-code',
                'doc': 'fa-file-word',
                'docx': 'fa-file-word',
                'xls': 'fa-file-excel',
                'xlsx': 'fa-file-excel',
                'ppt': 'fa-file-powerpoint',
                'pptx': 'fa-file-powerpoint',
                'txt': 'fa-file-text',
                'zip': 'fa-file-archive',
                'rar': 'fa-file-archive',
                'jpg': 'fa-file-image',
                'jpeg': 'fa-file-image',
                'png': 'fa-file-image',
                'gif': 'fa-file-image',
                'mp4': 'fa-file-video',
                'avi': 'fa-file-video',
                'mp3': 'fa-file-audio',
                'wav': 'fa-file-audio'
            };
            return icons[ext] || 'fa-file';
        }

        function getRandomSize() {
            const sizes = ['1.2 MB', '856 KB', '2.4 MB', '3.1 MB', '672 KB', '4.7 MB'];
            return sizes[Math.floor(Math.random() * sizes.length)];
        }

        function getRandomDate() {
            const dates = ['Today', 'Yesterday', '2 days ago', '3 days ago', 'Last week', '2 weeks ago'];
            return dates[Math.floor(Math.random() * dates.length)];
        }

        function showProgressDetails(circle) {
            const progress = circle.getAttribute('style').match(/--progress:\s*(\d+)/);
            const value = progress ? progress[1] : '75';
            
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.innerHTML = `
                <div class="progress-detail-modal">
                    <div class="progress-detail-header">
                        <h3><i class="fa-solid fa-chart-pie"></i> Study Progress</h3>
                        <button class="close-modal" onclick="this.closest('.modal-overlay').remove()">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    <div class="progress-detail-content">
                        <div class="large-progress-circle" style="--progress: ${value}">
                            <span>${value}%</span>
                        </div>
                        <div class="progress-stats">
                            <div class="stat-item">
                                <i class="fa-solid fa-clock"></i>
                                <div>
                                    <span class="stat-label">Hours Studied</span>
                                    <span class="stat-value">${Math.round(value * 0.16)} / 16</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fa-solid fa-target"></i>
                                <div>
                                    <span class="stat-label">Goals Completed</span>
                                    <span class="stat-value">${Math.round(value * 0.08)} / 8</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fa-solid fa-fire"></i>
                                <div>
                                    <span class="stat-label">Study Streak</span>
                                    <span class="stat-value">${Math.round(value * 0.05)} days</span>
                                </div>
                            </div>
                        </div>
                        <div class="progress-actions">
                            <button class="btn btn-primary" onclick="this.closest('.modal-overlay').remove()">
                                <i class="fa-solid fa-plus"></i> Add Study Session
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function showTrackerDetails(item) {
            const text = item.textContent.trim();
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.innerHTML = `
                <div class="tracker-detail-modal">
                    <div class="tracker-detail-header">
                        <h3><i class="fa-solid fa-calendar-check"></i> Study Tracker</h3>
                        <button class="close-modal" onclick="this.closest('.modal-overlay').remove()">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    <div class="tracker-detail-content">
                        <div class="tracker-info">
                            <h4>${text}</h4>
                            <div class="tracker-details">
                                <div class="detail-item">
                                    <i class="fa-solid fa-users"></i>
                                    <span>Study Group Members: 12</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fa-solid fa-clock"></i>
                                    <span>Duration: 2 hours</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fa-solid fa-book"></i>
                                    <span>Subject: Mathematics</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fa-solid fa-video"></i>
                                    <span>Platform: Video Conference</span>
                                </div>
                            </div>
                        </div>
                        <div class="tracker-actions">
                            <button class="btn btn-secondary">
                                <i class="fa-solid fa-bell"></i> Set Reminder
                            </button>
                            <button class="btn btn-primary">
                                <i class="fa-solid fa-calendar-plus"></i> Join Session
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function initializeStudyAnalytics() {
            
            const sidebar = document.querySelector('.sidebar-right');
            if (sidebar && !document.querySelector('.study-analytics-section')) {
                const analyticsSection = document.createElement('div');
                analyticsSection.className = 'card study-analytics-section';
                analyticsSection.innerHTML = `
                    <div class="analytics-header">
                        <h3><i class="fa-solid fa-chart-line"></i> Study Analytics</h3>
                        <button class="btn-refresh-analytics" onclick="refreshAnalytics()">
                            <i class="fa-solid fa-refresh"></i>
                        </button>
                    </div>
                    
                    <div class="analytics-content">
                        
                        <div class="analytics-metric">
                            <div class="metric-icon streak">
                                <i class="fa-solid fa-fire"></i>
                            </div>
                            <div class="metric-info">
                                <span class="metric-value" id="studyStreak">7</span>
                                <span class="metric-label">Day Streak</span>
                                <span class="metric-trend up">+2 this week</span>
                            </div>
                        </div>

                        
                        <div class="analytics-metric">
                            <div class="metric-icon focus">
                                <i class="fa-solid fa-bullseye"></i>
                            </div>
                            <div class="metric-info">
                                <span class="metric-value" id="focusScore">85%</span>
                                <span class="metric-label">Focus Score</span>
                                <span class="metric-trend up">+12% today</span>
                            </div>
                        </div>

                        
                        <div class="analytics-metric">
                            <div class="metric-icon progress">
                                <i class="fa-solid fa-chart-pie"></i>
                            </div>
                            <div class="metric-info">
                                <span class="metric-value" id="weeklyProgress">32h</span>
                                <span class="metric-label">This Week</span>
                                <span class="metric-trend neutral">Target: 40h</span>
                            </div>
                        </div>

                        
                        <div class="subject-performance">
                            <h4><i class="fa-solid fa-graduation-cap"></i> Subject Performance</h4>
                            <div class="performance-list">
                                <div class="performance-item">
                                    <span class="subject-name">Mathematics</span>
                                    <div class="performance-bar">
                                        <div class="performance-fill" style="--performance: 92%"></div>
                                    </div>
                                    <span class="performance-score">92%</span>
                                </div>
                                <div class="performance-item">
                                    <span class="subject-name">Physics</span>
                                    <div class="performance-bar">
                                        <div class="performance-fill" style="--performance: 87%"></div>
                                    </div>
                                    <span class="performance-score">87%</span>
                                </div>
                                <div class="performance-item">
                                    <span class="subject-name">Chemistry</span>
                                    <div class="performance-bar">
                                        <div class="performance-fill" style="--performance: 79%"></div>
                                    </div>
                                    <span class="performance-score">79%</span>
                                </div>
                            </div>
                        </div>

                        
                        <div class="recent-achievements">
                            <h4><i class="fa-solid fa-trophy"></i> Recent Achievements</h4>
                            <div class="achievements-list">
                                <div class="achievement-item">
                                    <div class="achievement-icon"></div>
                                    <div class="achievement-info">
                                        <span class="achievement-title">Study Marathon</span>
                                        <span class="achievement-desc">Studied 5 hours straight</span>
                                    </div>
                                    <span class="achievement-time">Today</span>
                                </div>
                                <div class="achievement-item">
                                    <div class="achievement-icon"></div>
                                    <div class="achievement-info">
                                        <span class="achievement-title">Perfect Week</span>
                                        <span class="achievement-desc">Met all daily goals</span>
                                    </div>
                                    <span class="achievement-time">Yesterday</span>
                                </div>
                                <div class="achievement-item">
                                    <div class="achievement-icon"></div>
                                    <div class="achievement-info">
                                        <span class="achievement-title">Knowledge Seeker</span>
                                        <span class="achievement-desc">Completed 50 tasks</span>
                                    </div>
                                    <span class="achievement-time">2 days ago</span>
                                </div>
                            </div>
                        </div>

                        
                        <div class="analytics-actions">
                            <button class="btn-analytics" onclick="showDetailedAnalytics()">
                                <i class="fa-solid fa-chart-column"></i>
                                <span>View Detailed Report</span>
                            </button>
                            <button class="btn-analytics" onclick="exportStudyData()">
                                <i class="fa-solid fa-download"></i>
                                <span>Export Data</span>
                            </button>
                        </div>
                    </div>
                `;
                sidebar.appendChild(analyticsSection);
                

            }
        }

        function showNavigationPreloader() {
            const preloader = document.createElement('div');
            preloader.className = 'navigation-preloader';
            preloader.innerHTML = `
                <div class="preloader-content">
                    <div class="preloader-spinner"></div>
                    <p>Loading page...</p>
                </div>
            `;
            
            document.body.appendChild(preloader);
            
            setTimeout(() => {
                if (document.body.contains(preloader)) {
                    preloader.remove();
                }
            }, 1000);
        }


        
        
        const dashboardGroups = [
            {
                id: 'group_1',
                name: 'Mathematics Study Circle',
                subject: 'Mathematics',
                memberCount: 24,
                type: 'public',
                avatar: '',
                lastActivity: '2 hours ago'
            },
            {
                id: 'group_2',
                name: 'Computer Science Hub',
                subject: 'Computer Science',
                memberCount: 156,
                type: 'public',
                avatar: '',
                lastActivity: '30 minutes ago'
            },
            {
                id: 'group_3',
                name: 'Physics Research Lab',
                subject: 'Physics',
                memberCount: 12,
                type: 'private',
                avatar: '',
                lastActivity: '4 hours ago'
            },
            {
                id: 'group_4',
                name: 'Chemistry Lab Partners',
                subject: 'Chemistry',
                memberCount: 8,
                type: 'private',
                avatar: '',
                lastActivity: '1 day ago'
            },
            {
                id: 'group_5',
                name: 'Engineering Design Team',
                subject: 'Engineering',
                memberCount: 45,
                type: 'public',
                avatar: '',
                lastActivity: '3 hours ago'
            }
        ];

        
        function navigateToGroup(groupId) {
            
            localStorage.setItem('selectedGroupId', groupId);
            
            window.location.href = 'html/groups.html';
        }

        
        function renderDashboardGroups() {
            const groupList = document.getElementById('dashboardGroupList');
            if (!groupList) return;

            const fragment = document.createDocumentFragment();
            
            dashboardGroups.forEach(group => {
                const li = document.createElement('li');
                li.className = 'group-item dashboard-group-item';
                li.setAttribute('data-group-id', group.id);
                
                li.innerHTML = `
                    <div class="group-avatar">${group.avatar}</div>
                    <div class="group-info">
                        <div class="group-name">${group.name}</div>
                        <div class="group-details">
                            ${group.memberCount} members  ${group.lastActivity}
                            ${group.type === 'private' ? '   Private' : ''}
                        </div>
                    </div>
                `;
                
                li.addEventListener('click', () => navigateToGroup(group.id), { passive: true });
                fragment.appendChild(li);
            });
            
            groupList.appendChild(fragment);
        }

        
        document.addEventListener('DOMContentLoaded', () => {
            
            mobileNav = new MobileNavigation();
            
            
            window.taskManager = new TaskManager();
            
            
            initializeAllButtons();
            
            
            initSmoothScrolling();
            initPerformanceOptimizations();
            
            renderDashboardGroups();
            
            
            function createAuthModal(type) {
                
                const existingModal = document.querySelector('.auth-modal');
                if (existingModal) {
                    existingModal.remove();
                }

                const modal = document.createElement('div');
                modal.className = 'auth-modal';
                
                const isLogin = type === 'login';
                const title = isLogin ? 'Sign In to StudyBuddy' : 'Join StudyBuddy';
                const submitText = isLogin ? 'Sign In' : 'Create Account';
                const switchText = isLogin ? "Don't have an account?" : "Already have an account?";
                const switchLink = isLogin ? 'Sign up' : 'Sign in';
                
                modal.innerHTML = `
                    <div class="auth-modal-overlay">
                        <div class="auth-modal-content">
                            <div class="auth-modal-header">
                                <h2>${title}</h2>
                                <button class="close-auth-modal" onclick="closeAuthModal()">
                                    <i class="fa-solid fa-times"></i>
                                </button>
                            </div>
                            <div class="auth-modal-body">
                                <form class="auth-form" onsubmit="handleAuthSubmit(event, '${type}')">
                                    ${!isLogin ? `
                                        <div class="form-group">
                                            <label for="authName">Full Name</label>
                                            <input type="text" id="authName" name="name" required 
                                                   placeholder="Enter your full name">
                                        </div>
                                    ` : ''}
                                    <div class="form-group">
                                        <label for="authEmail">Email Address</label>
                                        <input type="email" id="authEmail" name="email" required 
                                               placeholder="Enter your email">
                                    </div>
                                    <div class="form-group">
                                        <label for="authPassword">Password</label>
                                        <input type="password" id="authPassword" name="password" required 
                                               placeholder="Enter your password">
                                    </div>
                                    ${!isLogin ? `
                                        <div class="form-group">
                                            <label for="authConfirmPassword">Confirm Password</label>
                                            <input type="password" id="authConfirmPassword" name="confirmPassword" required 
                                                   placeholder="Confirm your password">
                                        </div>
                                    ` : ''}
                                    <button type="submit" class="auth-submit-btn">
                                        <i class="fa-solid fa-${isLogin ? 'sign-in-alt' : 'rocket'}"></i>
                                        ${submitText}
                                    </button>
                                </form>
                                <div class="auth-switch">
                                    <span>${switchText}</span>
                                    <button type="button" class="auth-switch-btn" 
                                            onclick="createAuthModal('${isLogin ? 'register' : 'login'}')">
                                        ${switchLink}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                
                const modalStyles = `
                    <style id="auth-modal-styles">
                        .auth-modal {
                            position: fixed;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            width: 100vw;
                            height: 100vh;
                            background: rgba(0, 0, 0, 0.8);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            z-index: 10001;
                            backdrop-filter: blur(10px);
                            padding: 20px;
                            box-sizing: border-box;
                            opacity: 0;
                            animation: authModalFadeIn 0.3s ease forwards;
                        }

                        .auth-modal-overlay {
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            width: 100%;
                            height: 100%;
                        }

                        .auth-modal-content {
                            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
                            border-radius: 20px;
                            width: 100%;
                            max-width: 400px;
                            max-height: 90vh;
                            overflow-y: auto;
                            border: 1px solid rgba(255, 255, 255, 0.1);
                            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
                            transform: scale(0.95) translateY(20px);
                            animation: authModalSlideIn 0.3s ease forwards;
                        }

                        .auth-modal-header {
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            padding: 25px 30px 20px 30px;
                            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                        }

                        .auth-modal-header h2 {
                            color: white;
                            font-size: 24px;
                            font-weight: 600;
                            margin: 0;
                        }

                        .close-auth-modal {
                            background: rgba(255, 255, 255, 0.1);
                            border: none;
                            color: white;
                            width: 35px;
                            height: 35px;
                            border-radius: 50%;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: all 0.3s ease;
                        }

                        .close-auth-modal:hover {
                            background: rgba(255, 255, 255, 0.2);
                            transform: scale(1.1);
                        }

                        .auth-modal-body {
                            padding: 30px;
                        }

                        .auth-form .form-group {
                            margin-bottom: 20px;
                        }

                        .auth-form label {
                            display: block;
                            color: rgba(255, 255, 255, 0.9);
                            font-size: 14px;
                            font-weight: 500;
                            margin-bottom: 8px;
                        }

                        .auth-form input {
                            width: 100%;
                            padding: 12px 15px;
                            background: rgba(255, 255, 255, 0.05);
                            border: 1px solid rgba(255, 255, 255, 0.2);
                            border-radius: 10px;
                            color: white;
                            font-size: 16px;
                            transition: all 0.3s ease;
                            box-sizing: border-box;
                        }

                        .auth-form input:focus {
                            outline: none;
                            border-color: #667eea;
                            background: rgba(255, 255, 255, 0.08);
                            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                        }

                        .auth-form input::placeholder {
                            color: rgba(255, 255, 255, 0.5);
                        }

                        .auth-submit-btn {
                            width: 100%;
                            padding: 15px;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 16px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            gap: 10px;
                            margin-top: 10px;
                        }

                        .auth-submit-btn:hover {
                            transform: translateY(-2px);
                            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
                        }

                        .auth-switch {
                            text-align: center;
                            margin-top: 25px;
                            padding-top: 20px;
                            border-top: 1px solid rgba(255, 255, 255, 0.1);
                            color: rgba(255, 255, 255, 0.7);
                            font-size: 14px;
                        }

                        .auth-switch-btn {
                            background: none;
                            border: none;
                            color: #667eea;
                            font-weight: 600;
                            cursor: pointer;
                            margin-left: 5px;
                            text-decoration: underline;
                        }

                        .auth-switch-btn:hover {
                            color: #5a6fd8;
                        }

                        @keyframes authModalFadeIn {
                            to { opacity: 1; }
                        }

                        @keyframes authModalSlideIn {
                            to { 
                                transform: scale(1) translateY(0);
                            }
                        }

                        
                        @media (max-width: 768px) {
                            .auth-modal {
                                padding: 10px !important;
                            }

                            .auth-modal-content {
                                max-width: 95% !important;
                                margin: 0 auto !important;
                            }

                            .auth-modal-header {
                                padding: 20px 20px 15px 20px;
                            }

                            .auth-modal-header h2 {
                                font-size: 20px;
                            }

                            .auth-modal-body {
                                padding: 20px;
                            }

                            .auth-form input {
                                font-size: 16px; 
                            }
                        }
                    </style>
                `;

                
                if (!document.getElementById('auth-modal-styles')) {
                    document.head.insertAdjacentHTML('beforeend', modalStyles);
                }

                document.body.appendChild(modal);

                
                setTimeout(() => {
                    const firstInput = modal.querySelector('input');
                    if (firstInput) {
                        firstInput.focus();
                    }
                }, 300);

                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal || e.target.className === 'auth-modal-overlay') {
                        closeAuthModal();
                    }
                });
            }

            function closeAuthModal() {
                const modal = document.querySelector('.auth-modal');
                if (modal) {
                    modal.style.opacity = '0';
                    modal.querySelector('.auth-modal-content').style.transform = 'scale(0.9) translateY(20px)';
                    setTimeout(() => {
                        modal.remove();
                    }, 200);
                }
            }

            
            window.closeAuthModal = closeAuthModal;

            function handleAuthSubmit(event, type) {
                event.preventDefault();
                const formData = new FormData(event.target);
                const data = Object.fromEntries(formData);

                
                if (type === 'register') {
                    if (data.password !== data.confirmPassword) {
                        showNotification('Passwords do not match!', 'error');
                        return;
                    }
                }

                
                showNotification(`${type === 'login' ? 'Signing in' : 'Creating account'}...`, 'info');
                
                setTimeout(() => {
                    closeAuthModal();
                    showNotification(`Welcome to StudyBuddy! ${type === 'login' ? 'Successfully signed in' : 'Account created successfully'}!`, 'success');
                    
                    
                    simulateLogin(data.name || data.email.split('@')[0]);
                }, 1000);
            }

            
            window.handleAuthSubmit = handleAuthSubmit;
            window.createAuthModal = createAuthModal;

            function simulateLogin(username) {
                const authSection = document.getElementById('authSection');
                const userSection = document.getElementById('userSection');
                
                if (authSection && userSection) {
                    authSection.style.display = 'none';
                    userSection.style.display = 'block';
                    
                    
                    const userName = userSection.querySelector('.user-name');
                    if (userName) {
                        userName.textContent = username;
                    }
                }
            }

            
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');
            
            if (loginBtn) {
                loginBtn.addEventListener('click', () => {
                    createAuthModal('login');
                });
            }
            
            if (signupBtn) {
                signupBtn.addEventListener('click', () => {
                    createAuthModal('register');
                });
            }
            
            
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    try {
                        await api.logout();
                        
                        window.location.reload();
                    } catch (error) {
                        console.error('Logout failed:', error);
                    }
                });
            }
            
            
            if (typeof api !== 'undefined') {
                api.checkAuthStatus().then(isAuthenticated => {
                    const authSection = document.getElementById('authSection');
                    const userSection = document.getElementById('userSection');
                    
                    if (isAuthenticated && authSection && userSection) {
                        authSection.style.display = 'none';
                        userSection.style.display = 'block';
                        
                        
                        if (mobileNav) {
                            mobileNav.updateAuthState(true);
                        }
                        
                        
                        if (api.user) {
                            const userNameElements = document.querySelectorAll('.user-name');
                            const userEmailElements = document.querySelectorAll('.user-email');
                            
                            userNameElements.forEach(el => {
                                el.textContent = api.user.full_name || api.user.username;
                            });
                            
                            userEmailElements.forEach(el => {
                                el.textContent = api.user.university || api.user.email;
                            });
                        }
                    } else if (authSection && userSection) {
                        authSection.style.display = 'flex';
                        userSection.style.display = 'none';
                        
                        
                        if (mobileNav) {
                            mobileNav.updateAuthState(false);
                        }
                    }
                }).catch(error => {
                    
                    if (mobileNav) {
                        mobileNav.updateAuthState(false);
                    }
                });
            } else {
                
                if (mobileNav) {
                    mobileNav.updateAuthState(false);
                }
            }
        });

        
        
        
        class StudyTracker {
            constructor() {
                this.startBtn = document.getElementById('startStudyBtn');
                this.pauseBtn = document.getElementById('pauseStudyBtn');
                this.stopBtn = document.getElementById('stopStudyBtn');
                this.currentTimeDisplay = document.getElementById('currentTime');
                this.sessionSubject = document.getElementById('sessionSubject');
                
                this.isRunning = false;
                this.isPaused = false;
                this.startTime = null;
                this.elapsedTime = 0;
                this.timerInterval = null;
                
                this.init();
            }
            
            init() {
                if (this.startBtn) {
                    this.startBtn.addEventListener('click', () => this.startSession());
                }
                if (this.pauseBtn) {
                    this.pauseBtn.addEventListener('click', () => this.pauseSession());
                }
                if (this.stopBtn) {
                    this.stopBtn.addEventListener('click', () => this.stopSession());
                }
                
                
                this.loadSession();
                this.updateDisplay();
            }
            
            startSession() {
                this.isRunning = true;
                this.isPaused = false;
                this.startTime = Date.now() - this.elapsedTime;
                
                this.startBtn.style.display = 'none';
                this.pauseBtn.style.display = 'flex';
                this.stopBtn.style.display = 'flex';
                
                this.timerInterval = setInterval(() => {
                    this.updateTimer();
                }, 1000);
                
                
                this.saveSession();
            }
            
            pauseSession() {
                this.isPaused = true;
                clearInterval(this.timerInterval);
                
                this.pauseBtn.style.display = 'none';
                this.startBtn.style.display = 'flex';
                
                this.saveSession();
            }
            
            stopSession() {
                this.isRunning = false;
                this.isPaused = false;
                clearInterval(this.timerInterval);
                
                
                this.saveCompletedSession();
                
                
                this.elapsedTime = 0;
                this.startTime = null;
                this.updateDisplay();
                
                this.startBtn.style.display = 'flex';
                this.pauseBtn.style.display = 'none';
                this.stopBtn.style.display = 'none';
                
                
                localStorage.removeItem('currentStudySession');
                
                
                this.updateDailyStats();
            }
            
            updateTimer() {
                if (this.isRunning && !this.isPaused) {
                    this.elapsedTime = Date.now() - this.startTime;
                    this.updateDisplay();
                    this.saveSession();
                }
            }
            
            updateDisplay() {
                if (this.currentTimeDisplay) {
                    const time = this.formatTime(this.elapsedTime);
                    this.currentTimeDisplay.textContent = time;
                }
            }
            
            formatTime(milliseconds) {
                const seconds = Math.floor(milliseconds / 1000);
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const secs = seconds % 60;
                
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
            
            saveSession() {
                const sessionData = {
                    isRunning: this.isRunning,
                    isPaused: this.isPaused,
                    startTime: this.startTime,
                    elapsedTime: this.elapsedTime,
                    subject: this.sessionSubject ? this.sessionSubject.value : '',
                    date: new Date().toDateString()
                };
                
                localStorage.setItem('currentStudySession', JSON.stringify(sessionData));
            }
            
            loadSession() {
                const savedSession = localStorage.getItem('currentStudySession');
                if (savedSession) {
                    const sessionData = JSON.parse(savedSession);
                    
                    
                    if (sessionData.date === new Date().toDateString()) {
                        this.isRunning = sessionData.isRunning;
                        this.isPaused = sessionData.isPaused;
                        this.startTime = sessionData.startTime;
                        this.elapsedTime = sessionData.elapsedTime;
                        
                        if (this.sessionSubject) {
                            this.sessionSubject.value = sessionData.subject || '';
                        }
                        
                        if (this.isRunning && !this.isPaused) {
                            this.startBtn.style.display = 'none';
                            this.pauseBtn.style.display = 'flex';
                            this.stopBtn.style.display = 'flex';
                            
                            this.timerInterval = setInterval(() => {
                                this.updateTimer();
                            }, 1000);
                        } else if (this.isPaused) {
                            this.startBtn.style.display = 'flex';
                            this.pauseBtn.style.display = 'none';
                            this.stopBtn.style.display = 'flex';
                        }
                    } else {
                        
                        localStorage.removeItem('currentStudySession');
                    }
                }
            }
            
            saveCompletedSession() {
                if (this.elapsedTime > 0) {
                    const sessions = JSON.parse(localStorage.getItem('studySessions') || '[]');
                    const newSession = {
                        date: new Date().toISOString(),
                        duration: this.elapsedTime,
                        subject: this.sessionSubject ? this.sessionSubject.value : 'General Study',
                        endTime: Date.now()
                    };
                    
                    sessions.push(newSession);
                    localStorage.setItem('studySessions', JSON.stringify(sessions));
                }
            }
            
            updateDailyStats() {
                
                
            }
        }

        
        class QuickStats {
            constructor() {
                this.statsData = this.loadStatsData();
                this.taskManager = null; 
                this.initializeElements();
                this.updateDisplay();
                this.startLiveUpdates();
                
                
                setInterval(() => {
                    this.updateLiveData();
                }, 30000);
                
                
                window.addEventListener('storage', (e) => {
                    if (e.key === 'studyBuddyTasks') {
                        this.updateTaskStats();
                        this.updateDisplay();
                    }
                });
            }
            
            initializeElements() {
                this.refreshBtn = document.querySelector('.refresh-stats-btn');
                this.studyTimeValue = document.querySelector('.study-time .stat-value');
                this.streakValue = document.querySelector('.streak .stat-value');
                this.productivityValue = document.querySelector('.productivity .stat-value');
                this.completionValue = document.querySelector('.completion .stat-value');
                
                this.quickActionBtns = document.querySelectorAll('.quick-action-btn');
                this.updatesList = document.querySelector('.update-list');
                this.goalsList = document.querySelector('.goals-list');
                
                this.attachEventListeners();
            }
            
            attachEventListeners() {
                if (this.refreshBtn) {
                    this.refreshBtn.addEventListener('click', () => {
                        this.refreshStats();
                    });
                }
                
                this.quickActionBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const action = btn.className.includes('study-btn') ? 'study' :
                                      btn.className.includes('break-btn') ? 'break' : 'review';
                        this.handleQuickAction(action);
                    });
                });
                
                
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.goal-item')) {
                        this.toggleGoal(e.target.closest('.goal-item'));
                    }
                });
            }
            
            loadStatsData() {
                const defaultStats = {
                    todayStudyTime: 0,
                    currentStreak: 1,
                    weeklyProductivity: 78,
                    tasksCompleted: 0,
                    totalTasks: 0,
                    lastUpdated: Date.now(),
                    dailyGoals: [],
                    recentUpdates: []
                };
                
                const saved = localStorage.getItem('quickStatsData');
                const statsData = saved ? { ...defaultStats, ...JSON.parse(saved) } : defaultStats;
                
                
                this.updateTaskStats(statsData);
                
                return statsData;
            }
            
            updateTaskStats(statsData = null) {
                const stats = statsData || this.statsData;
                const tasks = this.loadTasksData();
                
                if (tasks && tasks.length > 0) {
                    stats.totalTasks = tasks.length;
                    stats.tasksCompleted = tasks.filter(task => task.completed).length;
                    
                    
                    const incompleteTasks = tasks.filter(task => !task.completed);
                    const completedTasks = tasks.filter(task => task.completed);
                    
                    stats.dailyGoals = [];
                    
                    
                    completedTasks.slice(0, 2).forEach((task, index) => {
                        stats.dailyGoals.push({
                            id: task.id,
                            text: task.title,
                            completed: true,
                            progress: 100,
                            priority: task.priority,
                            dueDate: task.dueDate
                        });
                    });
                    
                    
                    incompleteTasks.slice(0, 4).forEach((task, index) => {
                        const progress = this.calculateTaskProgress(task);
                        stats.dailyGoals.push({
                            id: task.id,
                            text: task.title,
                            completed: false,
                            progress: progress,
                            priority: task.priority,
                            dueDate: task.dueDate
                        });
                    });
                    
                    
                    stats.weeklyProductivity = Math.round((stats.tasksCompleted / stats.totalTasks) * 100);
                } else {
                    
                    stats.totalTasks = 0;
                    stats.tasksCompleted = 0;
                    stats.weeklyProductivity = 0;
                    stats.dailyGoals = [];
                }
                
                return stats;
            }
            
            loadTasksData() {
                try {
                    const saved = localStorage.getItem('studyBuddyTasks');
                    return saved ? JSON.parse(saved) : [];
                } catch (e) {
                    console.error('Error loading tasks for QuickStats:', e);
                    return [];
                }
            }
            
            calculateTaskProgress(task) {
                
                const now = new Date();
                const createdAt = new Date(task.createdAt);
                const daysSinceCreated = Math.floor((now - createdAt) / (1000 * 60 * 60 * 24));
                
                let progress = 0;
                
                
                if (daysSinceCreated >= 1) progress += 25;
                if (daysSinceCreated >= 3) progress += 25;
                
                
                if (task.priority === 'high') progress += 20;
                else if (task.priority === 'medium') progress += 10;
                
                
                if (task.dueDate) {
                    const dueDate = new Date(task.dueDate);
                    const daysUntilDue = Math.floor((dueDate - now) / (1000 * 60 * 60 * 24));
                    if (daysUntilDue <= 1) progress += 30; 
                    else if (daysUntilDue <= 3) progress += 15; 
                }
                
                return Math.min(progress, 95); 
            }
            
            saveStatsData() {
                localStorage.setItem('quickStatsData', JSON.stringify(this.statsData));
            }
            
            updateDisplay() {
                
                const hours = Math.floor(this.statsData.todayStudyTime / 3600);
                const minutes = Math.floor((this.statsData.todayStudyTime % 3600) / 60);
                if (this.studyTimeValue) {
                    this.studyTimeValue.textContent = `${hours}h ${minutes}m`;
                }
                
                if (this.streakValue) {
                    this.streakValue.textContent = `${this.statsData.currentStreak} days`;
                }
                
                if (this.productivityValue) {
                    this.productivityValue.textContent = `${this.statsData.weeklyProductivity}%`;
                }
                
                if (this.completionValue) {
                    this.completionValue.textContent = `${this.statsData.tasksCompleted}/${this.statsData.totalTasks}`;
                }
                
                
                this.updateProgressBars();
                
                
                this.updateGoalsDisplay();
                
                
                this.updateRecentActivity();
            }
            
            updateProgressBars() {
                const progressBars = document.querySelectorAll('.progress-bar');
                progressBars.forEach(bar => {
                    if (bar.closest('.study-time')) {
                        const progress = Math.min((this.statsData.todayStudyTime / (8 * 3600)) * 100, 100);
                        bar.style.setProperty('--progress', progress + '%');
                    } else if (bar.closest('.completion')) {
                        const progress = (this.statsData.tasksCompleted / this.statsData.totalTasks) * 100;
                        bar.style.setProperty('--progress', progress + '%');
                    }
                });
            }
            
            updateGoalsDisplay() {
                if (!this.goalsList) return;
                
                this.goalsList.innerHTML = '';
                this.statsData.dailyGoals.forEach(goal => {
                    const goalElement = document.createElement('div');
                    goalElement.className = `goal-item ${goal.completed ? 'completed' : goal.progress > 0 ? 'in-progress' : ''}`;
                    goalElement.dataset.goalId = goal.id;
                    
                    goalElement.innerHTML = `
                        <i class="fa-solid ${goal.completed ? 'fa-check-circle' : goal.progress > 0 ? 'fa-clock' : 'fa-circle'}"></i>
                        <span>${goal.text}</span>
                        <div class="goal-progress">
                            <div class="goal-bar" style="--goal-width: ${goal.progress}%"></div>
                        </div>
                    `;
                    
                    this.goalsList.appendChild(goalElement);
                });
            }
            
            updateRecentActivity() {
                if (!this.updatesList) return;
                
                const savedUpdates = this.statsData.recentUpdates || [];
                const tasks = this.loadTasksData();
                
                
                const taskActivities = this.generateTaskActivities(tasks);
                
                
                const allUpdates = [...taskActivities, ...savedUpdates].slice(0, 4);
                
                this.updatesList.innerHTML = '';
                allUpdates.forEach((update, index) => {
                    const updateElement = document.createElement('div');
                    updateElement.className = 'update-item';
                    updateElement.innerHTML = `
                        <div class="update-dot ${update.active ? 'active' : ''}"></div>
                        <div class="update-content">
                            <span class="update-text">${update.text}</span>
                            <span class="update-time">${update.time}</span>
                        </div>
                    `;
                    this.updatesList.appendChild(updateElement);
                });
            }
            
            generateTaskActivities(tasks) {
                const activities = [];
                const now = new Date();
                
                if (tasks && tasks.length > 0) {
                    
                    const recentTasks = [...tasks].sort((a, b) => {
                        const aTime = new Date(a.completedAt || a.createdAt);
                        const bTime = new Date(b.completedAt || b.createdAt);
                        return bTime - aTime;
                    });
                    
                    recentTasks.slice(0, 3).forEach(task => {
                        if (task.completed && task.completedAt) {
                            const completedTime = new Date(task.completedAt);
                            const timeAgo = this.getTimeAgo(completedTime);
                            activities.push({
                                text: `Completed: ${task.title}`,
                                time: timeAgo,
                                active: false
                            });
                        } else {
                            const createdTime = new Date(task.createdAt);
                            const timeAgo = this.getTimeAgo(createdTime);
                            if (createdTime > new Date(now - 24 * 60 * 60 * 1000)) { 
                                activities.push({
                                    text: `Added task: ${task.title}`,
                                    time: timeAgo,
                                    active: false
                                });
                            }
                        }
                    });
                }
                
                return activities;
            }
            
            getTimeAgo(date) {
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / (1000 * 60));
                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
                const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                
                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins} minute${diffMins !== 1 ? 's' : ''} ago`;
                if (diffHours < 24) return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;
                if (diffDays === 1) return 'Yesterday';
                if (diffDays < 7) return `${diffDays} days ago`;
                return date.toLocaleDateString();
            }
            
            refreshStats() {
                
                this.refreshBtn.style.transform = 'rotate(180deg)';
                
                setTimeout(() => {
                    
                    this.statsData.weeklyProductivity = Math.max(70, Math.min(100, 
                        this.statsData.weeklyProductivity + (Math.random() - 0.5) * 10));
                    
                    this.updateDisplay();
                    this.saveStatsData();
                    
                    this.refreshBtn.style.transform = 'rotate(0deg)';
                    
                    
                    this.addRecentUpdate("Statistics refreshed", "Just now", true);
                }, 500);
            }
            
            handleQuickAction(action) {
                const actionText = {
                    'study': 'Started quick study session',
                    'break': 'Taking a 15-minute break',
                    'review': 'Reviewing recent notes'
                };
                
                
                const btn = document.querySelector(`.${action}-btn`);
                if (btn) {
                    btn.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        btn.style.transform = 'scale(1)';
                    }, 150);
                }
                
                
                this.addRecentUpdate(actionText[action], "Just now", action === 'study');
                
                
                if (action === 'study') {
                    
                    this.startQuickSession();
                } else if (action === 'break') {
                    
                    this.logBreak();
                }
            }
            
            addRecentUpdate(text, time, active = false) {
                if (!this.updatesList) return;
                
                const updateElement = document.createElement('div');
                updateElement.className = 'update-item';
                updateElement.innerHTML = `
                    <div class="update-dot ${active ? 'active' : ''}"></div>
                    <div class="update-content">
                        <span class="update-text">${text}</span>
                        <span class="update-time">${time}</span>
                    </div>
                `;
                
                
                document.querySelectorAll('.update-dot.active').forEach(dot => {
                    dot.classList.remove('active');
                });
                
                this.updatesList.insertBefore(updateElement, this.updatesList.firstChild);
                
                
                while (this.updatesList.children.length > 4) {
                    this.updatesList.removeChild(this.updatesList.lastChild);
                }
            }
            
            toggleGoal(goalElement) {
                const goalId = goalElement.dataset.goalId;
                const goal = this.statsData.dailyGoals.find(g => g.id === goalId);
                
                if (goal && !goal.completed) {
                    
                    if (goalId.startsWith('task_')) {
                        this.completeTaskInTaskManager(goalId);
                        goal.completed = true;
                        goal.progress = 100;
                        this.addRecentUpdate(`Completed: ${goal.text}`, "Just now");
                    } else {
                        
                        goal.progress = goal.progress < 100 ? goal.progress + 25 : 100;
                        if (goal.progress >= 100) {
                            goal.completed = true;
                            this.addRecentUpdate(`Completed: ${goal.text}`, "Just now");
                        }
                    }
                    
                    this.updateTaskStats();
                    this.updateDisplay();
                    this.saveStatsData();
                }
            }
            
            completeTaskInTaskManager(taskId) {
                
                try {
                    const tasks = this.loadTasksData();
                    const task = tasks.find(t => t.id === taskId);
                    if (task && !task.completed) {
                        task.completed = true;
                        task.completedAt = new Date().toISOString();
                        localStorage.setItem('studyBuddyTasks', JSON.stringify(tasks));
                        
                        
                        if (window.taskManager) {
                            window.taskManager.tasks = tasks;
                            window.taskManager.renderTasks();
                        }
                    }
                } catch (e) {
                    console.error('Error completing task:', e);
                }
            }
            
            startQuickSession() {
                
                this.addRecentUpdate("25-minute study session started", "Just now", true);
                
                
                const increment = setInterval(() => {
                    this.statsData.todayStudyTime += 60; 
                    this.updateDisplay();
                    this.saveStatsData();
                }, 60000); 
                
                
                setTimeout(() => {
                    clearInterval(increment);
                    this.addRecentUpdate("Study session completed!", "Just now");
                }, 1500000); 
            }
            
            logBreak() {
                this.addRecentUpdate("Break time logged", "Just now");
                
            }
            
            updateLiveData() {
                
                const currentTime = new Date();
                const timeString = currentTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                
                const updateTimes = document.querySelectorAll('.update-time');
                updateTimes.forEach((timeEl, index) => {
                    if (index === 0 && !timeEl.textContent.includes('Just now')) {
                        const minutes = Math.floor(Math.random() * 5) + 1;
                        timeEl.textContent = `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
                    }
                });
            }
            
            startLiveUpdates() {
                
                setInterval(() => {
                    
                    if (Math.random() < 0.1) { 
                        const change = (Math.random() - 0.5) * 2; 
                        this.statsData.weeklyProductivity = Math.max(0, Math.min(100, 
                            this.statsData.weeklyProductivity + change));
                        this.updateDisplay();
                        this.saveStatsData();
                    }
                }, 30000);
            }
            
            setupTaskChangeListeners() {
                
                if (this.taskManager) {
                    const originalAddTask = this.taskManager.addTask.bind(this.taskManager);
                    const originalSaveQuickTask = this.taskManager.saveQuickTask.bind(this.taskManager);
                    const originalToggleTask = this.taskManager.toggleTask.bind(this.taskManager);
                    const originalRemoveTask = this.taskManager.removeTask.bind(this.taskManager);
                    
                    
                    this.taskManager.addTask = (...args) => {
                        const result = originalAddTask(...args);
                        this.onTaskAdded();
                        return result;
                    };
                    
                    
                    this.taskManager.saveQuickTask = (...args) => {
                        const taskText = this.taskManager.quickInput?.value?.trim();
                        const result = originalSaveQuickTask(...args);
                        if (taskText) {
                            this.onTaskAdded(taskText);
                        }
                        return result;
                    };
                    
                    
                    this.taskManager.toggleTask = (taskId) => {
                        const task = this.taskManager.tasks.find(t => t.id === taskId);
                        const wasCompleted = task?.completed;
                        const result = originalToggleTask(taskId);
                        
                        if (task) {
                            if (!wasCompleted && task.completed) {
                                this.onTaskCompleted(task.title);
                            } else if (wasCompleted && !task.completed) {
                                this.onTaskUncompleted(task.title);
                            }
                        }
                        return result;
                    };
                    
                    
                    this.taskManager.removeTask = (taskId) => {
                        const task = this.taskManager.tasks.find(t => t.id === taskId);
                        const result = originalRemoveTask(taskId);
                        if (task) {
                            this.onTaskRemoved(task.title);
                        }
                        return result;
                    };
                }
            }
            
            onTaskAdded(taskTitle) {
                this.addRecentUpdate(
                    taskTitle ? `Added: ${taskTitle}` : 'New task added', 
                    'Just now', 
                    false
                );
                this.updateTaskStats();
                this.updateDisplay();
                this.saveStatsData();
            }
            
            onTaskCompleted(taskTitle) {
                this.addRecentUpdate(`Completed: ${taskTitle}`, 'Just now', false);
                this.updateTaskStats();
                this.updateDisplay();
                this.saveStatsData();
                
                
                this.addCompletionCelebration();
            }
            
            onTaskUncompleted(taskTitle) {
                this.addRecentUpdate(`Reopened: ${taskTitle}`, 'Just now', false);
                this.updateTaskStats();
                this.updateDisplay();
                this.saveStatsData();
            }
            
            onTaskRemoved(taskTitle) {
                this.addRecentUpdate(`Removed: ${taskTitle}`, 'Just now', false);
                this.updateTaskStats();
                this.updateDisplay();
                this.saveStatsData();
            }
            
            addCompletionCelebration() {
                
                const completionValue = document.querySelector('.completion .stat-value');
                if (completionValue) {
                    completionValue.style.transform = 'scale(1.2)';
                    completionValue.style.color = '#10b981';
                    setTimeout(() => {
                        completionValue.style.transform = 'scale(1)';
                        completionValue.style.color = '';
                    }, 500);
                }
                
                
                this.statsData.weeklyProductivity = Math.min(100, this.statsData.weeklyProductivity + 2);
            }
        }

        
        window.quickStats = null;
        window.taskManager = null;
        window.studyTracker = null;

        
        document.addEventListener('DOMContentLoaded', () => {
            window.studyTracker = new StudyTracker();
            window.taskManager = new TaskManager();
            window.quickStats = new QuickStats();
            
            
            window.quickStats.taskManager = window.taskManager;
            
            
            window.quickStats.setupTaskChangeListeners();
        });

        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        
        function refreshAnalytics() {
            
            const refreshBtn = document.querySelector('.btn-refresh-analytics i');
            if (refreshBtn) {
                refreshBtn.style.transform = 'rotate(360deg)';
                setTimeout(() => {
                    refreshBtn.style.transform = 'rotate(0deg)';
                    updateAnalyticsData();
                }, 600);
            }
        }

        function updateAnalyticsData() {
            
            const streakEl = document.getElementById('studyStreak');
            if (streakEl) {
                const currentStreak = parseInt(streakEl.textContent);
                const newStreak = Math.max(1, currentStreak + Math.floor(Math.random() * 3) - 1);
                streakEl.textContent = newStreak;
            }

            
            const focusEl = document.getElementById('focusScore');
            if (focusEl) {
                const scores = ['78%', '82%', '85%', '89%', '92%', '95%'];
                focusEl.textContent = scores[Math.floor(Math.random() * scores.length)];
            }

            
            const progressEl = document.getElementById('weeklyProgress');
            if (progressEl) {
                const hours = [28, 32, 35, 38, 42, 45];
                progressEl.textContent = hours[Math.floor(Math.random() * hours.length)] + 'h';
            }

            
            const performanceBars = document.querySelectorAll('.performance-fill');
            performanceBars.forEach(bar => {
                const currentWidth = bar.style.getPropertyValue('--performance');
                bar.style.setProperty('--performance', '0%');
                setTimeout(() => {
                    bar.style.setProperty('--performance', currentWidth);
                }, 100);
            });
        }

        function initializeDetailedEfficiencyChart() {
            const canvas = document.getElementById('detailedEfficiencyChart');
            if (!canvas) return;

            const container = canvas.parentElement;
            const containerWidth = container.clientWidth;
            
            
            canvas.width = Math.min(containerWidth - 40, 700);
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            
            ctx.clearRect(0, 0, width, height);

            
            const data = [68, 72, 75, 79, 82, 78, 85, 88, 92, 89, 87, 91, 94, 90];
            const labels = ['Nov 22', 'Nov 23', 'Nov 24', 'Nov 25', 'Nov 26', 'Nov 27', 'Nov 28', 
                          'Nov 29', 'Nov 30', 'Dec 1', 'Dec 2', 'Dec 3', 'Dec 4', 'Dec 5'];

            
            const padding = 50;
            const bottomPadding = 60;
            const leftPadding = 60;
            const chartWidth = width - leftPadding - padding;
            const chartHeight = height - padding - bottomPadding;

            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.15)';
            ctx.lineWidth = 1;

            
            for (let i = 0; i <= 5; i++) {
                const y = padding + (i * chartHeight / 5);
                const percentage = 100 - (i * 20);
                
                ctx.beginPath();
                ctx.moveTo(leftPadding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
                
                
                ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                ctx.fillText(percentage + '%', leftPadding - 10, y);
            }

            
            for (let i = 0; i <= data.length - 1; i++) {
                const x = leftPadding + (i * chartWidth / (data.length - 1));
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, padding + chartHeight);
                ctx.stroke();
            }

            
            const gradient = ctx.createLinearGradient(0, padding, 0, padding + chartHeight);
            gradient.addColorStop(0, 'rgba(74, 222, 128, 0.3)');
            gradient.addColorStop(1, 'rgba(74, 222, 128, 0.05)');
            
            ctx.beginPath();
            data.forEach((value, index) => {
                const x = leftPadding + (index * chartWidth / (data.length - 1));
                const y = padding + chartHeight - (value / 100 * chartHeight);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.lineTo(leftPadding + chartWidth, padding + chartHeight);
            ctx.lineTo(leftPadding, padding + chartHeight);
            ctx.closePath();
            ctx.fillStyle = gradient;
            ctx.fill();

            
            ctx.strokeStyle = '#4ade80';
            ctx.lineWidth = 4;
            ctx.beginPath();

            data.forEach((value, index) => {
                const x = leftPadding + (index * chartWidth / (data.length - 1));
                const y = padding + chartHeight - (value / 100 * chartHeight);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                
                ctx.save();
                
                
                ctx.shadowColor = '#4ade80';
                ctx.shadowBlur = 10;
                ctx.fillStyle = '#4ade80';
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2 * Math.PI);
                ctx.fill();
                
                
                ctx.shadowBlur = 0;
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
                
                ctx.restore();
            });

            ctx.stroke();

            
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';

            labels.forEach((label, index) => {
                if (index % 2 === 0) { 
                    const x = leftPadding + (index * chartWidth / (labels.length - 1));
                    const labelY = height - bottomPadding + 15;
                    
                    
                    ctx.save();
                    ctx.translate(x, labelY);
                    ctx.rotate(-Math.PI / 4);
                    ctx.fillText(label, 0, 0);
                    ctx.restore();
                }
            });

            
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('14-Day Efficiency Trend Analysis', width / 2, 25);
        }

        function showDetailedAnalytics() {
            
            const modal = document.createElement('div');
            modal.className = 'analytics-modal';
            modal.innerHTML = `
                <div class="analytics-modal-content">
                    <div class="analytics-modal-header">
                        <h2><i class="fa-solid fa-chart-column"></i> Detailed Analytics Report</h2>
                        <button class="close-analytics-modal" onclick="closeAnalyticsModal()">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    <div class="analytics-modal-body">
                        <div class="detailed-stats">
                            <div class="stat-card full-width">
                                <h3><i class="fa-solid fa-chart-line"></i> Daily Efficiency Trends</h3>
                                <div class="large-chart-container">
                                    <canvas id="detailedEfficiencyChart" width="700" height="300"></canvas>
                                </div>
                                <div class="chart-insights">
                                    <div class="insight-item">
                                        <span class="insight-label">Peak Day:</span>
                                        <span class="insight-value">Saturday (92%)</span>
                                    </div>
                                    <div class="insight-item">
                                        <span class="insight-label">Average:</span>
                                        <span class="insight-value">84.1%</span>
                                    </div>
                                    <div class="insight-item">
                                        <span class="insight-label">Trend:</span>
                                        <span class="insight-value trend-up"> Improving</span>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <h3>Study Time Distribution</h3>
                                <div class="time-breakdown">
                                    <div class="time-item">
                                        <span class="subject">Mathematics</span>
                                        <span class="time">12.5h</span>
                                        <div class="percentage">35%</div>
                                    </div>
                                    <div class="time-item">
                                        <span class="subject">Physics</span>
                                        <span class="time">9.2h</span>
                                        <div class="percentage">26%</div>
                                    </div>
                                    <div class="time-item">
                                        <span class="subject">Chemistry</span>
                                        <span class="time">8.1h</span>
                                        <div class="percentage">23%</div>
                                    </div>
                                    <div class="time-item">
                                        <span class="subject">Biology</span>
                                        <span class="time">5.7h</span>
                                        <div class="percentage">16%</div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <h3>Weekly Goals Progress</h3>
                                <div class="goals-progress">
                                    <div class="goal-item">
                                        <span class="goal-name">Study 40 hours</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 80%"></div>
                                        </div>
                                        <span class="goal-status">32/40h</span>
                                    </div>
                                    <div class="goal-item">
                                        <span class="goal-name">Complete 50 tasks</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 92%"></div>
                                        </div>
                                        <span class="goal-status">46/50</span>
                                    </div>
                                    <div class="goal-item">
                                        <span class="goal-name">Maintain focus >85%</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 100%"></div>
                                        </div>
                                        <span class="goal-status">89%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            
            const modalStyles = `
                <style>
                .analytics-modal {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    width: 100vw;
                    height: 100vh;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    backdrop-filter: blur(10px);
                    padding: 20px;
                    box-sizing: border-box;
                }
                .analytics-modal-content {
                    background: linear-gradient(145deg, #1a1a2e 0%, #16213e 100%);
                    border-radius: 20px;
                    padding: 30px;
                    width: 100%;
                    max-width: 800px;
                    max-height: 80vh;
                    overflow-y: auto;
                    color: white;
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                    margin: auto;
                    position: relative;
                    transform: scale(0.95) translateY(20px);
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                }
                .analytics-modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 25px;
                    padding-bottom: 15px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
                }
                .close-analytics-modal {
                    background: rgba(255, 255, 255, 0.1);
                    border: none;
                    color: white;
                    padding: 10px;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                .close-analytics-modal:hover {
                    background: rgba(255, 255, 255, 0.2);
                }
                .detailed-stats {
                    display: grid;
                    gap: 20px;
                }
                .stat-card {
                    background: rgba(255, 255, 255, 0.1);
                    padding: 20px;
                    border-radius: 15px;
                    backdrop-filter: blur(10px);
                }
                .stat-card.full-width {
                    grid-column: 1 / -1;
                }
                .large-chart-container {
                    position: relative;
                    height: 300px;
                    width: 100%;
                    margin: 15px 0;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    background: rgba(0, 0, 0, 0.2);
                    border-radius: 10px;
                    overflow: hidden;
                }
                .large-chart-container canvas {
                    max-width: 100%;
                    height: auto;
                    display: block;
                }
                .chart-insights {
                    display: flex;
                    justify-content: space-around;
                    margin-top: 15px;
                    padding-top: 15px;
                    border-top: 1px solid rgba(255, 255, 255, 0.2);
                }
                .insight-item {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 5px;
                }
                .insight-label {
                    font-size: 12px;
                    opacity: 0.8;
                }
                .insight-value {
                    font-size: 16px;
                    font-weight: 600;
                }
                .insight-value.trend-up {
                    color: #4ade80;
                }
                .time-breakdown, .goals-progress {
                    margin-top: 15px;
                }
                .time-item, .goal-item {
                    display: flex;
                    align-items: center;
                    gap: 15px;
                    padding: 10px 0;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                }
                .time-item:last-child, .goal-item:last-child {
                    border-bottom: none;
                }
                .subject, .goal-name {
                    flex: 1;
                    font-weight: 500;
                }
                .time, .goal-status {
                    font-weight: 600;
                    min-width: 60px;
                    text-align: right;
                }
                .percentage {
                    background: rgba(74, 222, 128, 0.2);
                    color: #4ade80;
                    padding: 4px 8px;
                    border-radius: 6px;
                    font-size: 12px;
                    font-weight: 600;
                    min-width: 40px;
                    text-align: center;
                }
                .progress-bar {
                    flex: 1;
                    height: 8px;
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 4px;
                    overflow: hidden;
                }
                .progress-fill {
                    height: 100%;
                    background: linear-gradient(90deg, #4ade80, #22c55e);
                    border-radius: 4px;
                    transition: width 1s ease;
                }

                
                @media (max-width: 768px) {
                    .analytics-modal {
                        padding: 10px !important;
                        width: 100vw !important;
                        height: 100vh !important;
                        position: fixed !important;
                        top: 0 !important;
                        left: 0 !important;
                        right: 0 !important;
                        bottom: 0 !important;
                        display: flex !important;
                        align-items: center !important;
                        justify-content: center !important;
                    }

                    .analytics-modal-content {
                        width: 95% !important;
                        max-width: 400px !important;
                        max-height: 90vh !important;
                        padding: 20px !important;
                        margin: 0 auto !important;
                        border-radius: 15px;
                        transform: scale(0.98) translateY(10px) !important;
                        overflow-y: auto;
                        -webkit-overflow-scrolling: touch;
                    }

                    .analytics-modal-content.show {
                        transform: scale(1) translateY(0) !important;
                    }

                    .analytics-modal-header {
                        padding-bottom: 10px;
                        margin-bottom: 15px;
                        flex-direction: column;
                        gap: 10px;
                        text-align: center;
                    }

                    .analytics-modal-header h2 {
                        font-size: 18px !important;
                    }

                    .close-analytics-modal {
                        width: 35px !important;
                        height: 35px !important;
                        font-size: 16px !important;
                        position: absolute;
                        top: 15px;
                        right: 15px;
                    }

                    .detailed-stats {
                        gap: 15px;
                    }

                    .stat-card {
                        padding: 15px !important;
                        margin-bottom: 15px;
                    }

                    .stat-card h3 {
                        font-size: 16px !important;
                        margin-bottom: 10px !important;
                    }

                    .large-chart-container {
                        max-width: 100%;
                        overflow-x: auto;
                        -webkit-overflow-scrolling: touch;
                    }

                    .large-chart-container canvas {
                        max-width: 100% !important;
                        height: auto !important;
                    }

                    .chart-insights {
                        flex-direction: column !important;
                        gap: 8px !important;
                    }

                    .insight-item {
                        flex-direction: column !important;
                        align-items: flex-start !important;
                        gap: 2px !important;
                    }

                    .time-breakdown {
                        gap: 10px !important;
                    }

                    .time-item {
                        padding: 10px !important;
                        font-size: 14px !important;
                    }

                    .goals-progress {
                        gap: 12px !important;
                    }

                    .goal-item {
                        padding: 12px !important;
                    }

                    .goal-name {
                        font-size: 14px !important;
                        margin-bottom: 5px !important;
                    }

                    .progress-bar {
                        margin: 8px 0 !important;
                    }

                    
                    .analytics-modal-content::-webkit-scrollbar {
                        width: 4px;
                    }

                    .analytics-modal-content::-webkit-scrollbar-track {
                        background: rgba(255, 255, 255, 0.1);
                        border-radius: 2px;
                    }

                    .analytics-modal-content::-webkit-scrollbar-thumb {
                        background: rgba(255, 255, 255, 0.3);
                        border-radius: 2px;
                    }
                }
                </style>
            `;

            document.head.insertAdjacentHTML('beforeend', modalStyles);
            document.body.appendChild(modal);

            
            function ensureAnalyticsModalCentered() {
                const modalElement = document.querySelector('.analytics-modal');
                const modalContent = document.querySelector('.analytics-modal-content');
                
                if (modalElement && modalContent) {
                    
                    modalElement.style.position = 'fixed';
                    modalElement.style.top = '0';
                    modalElement.style.left = '0';
                    modalElement.style.right = '0';
                    modalElement.style.bottom = '0';
                    modalElement.style.width = '100vw';
                    modalElement.style.height = '100vh';
                    modalElement.style.display = 'flex';
                    modalElement.style.alignItems = 'center';
                    modalElement.style.justifyContent = 'center';
                    modalElement.style.margin = '0';
                    modalElement.style.padding = window.innerWidth <= 768 ? '10px' : '20px';

                    
                    if (window.innerWidth <= 768) {
                        setTimeout(() => {
                            modalContent.classList.add('show');
                        }, 50);
                    }

                    
                    modalElement.offsetHeight;
                }
            }

            
            ensureAnalyticsModalCentered();

            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeAnalyticsModal();
                }
            });

            
            if (window.innerWidth <= 768) {
                modal.addEventListener('touchstart', (e) => {
                    if (e.target === modal) {
                        closeAnalyticsModal();
                    }
                });
            }

            
            setTimeout(() => {
                initializeDetailedEfficiencyChart();
                
                ensureAnalyticsModalCentered();
            }, 100);
        }

        function closeAnalyticsModal() {
            const modal = document.querySelector('.analytics-modal');
            const modalContent = document.querySelector('.analytics-modal-content');
            
            if (modal && modalContent) {
                
                if (window.innerWidth <= 768) {
                    modalContent.classList.remove('show');
                    modalContent.style.transform = 'scale(0.95) translateY(20px)';
                    modalContent.style.opacity = '0.5';
                    
                    setTimeout(() => {
                        modal.remove();
                    }, 200);
                } else {
                    modal.remove();
                }
            }
        }

        function exportStudyData() {
            
            const studyData = {
                exportDate: new Date().toISOString(),
                studyStreak: document.getElementById('studyStreak')?.textContent || '7',
                focusScore: document.getElementById('focusScore')?.textContent || '85%',
                weeklyProgress: document.getElementById('weeklyProgress')?.textContent || '32h',
                subjects: [
                    { name: 'Mathematics', performance: '92%', hoursStudied: '12.5h' },
                    { name: 'Physics', performance: '87%', hoursStudied: '9.2h' },
                    { name: 'Chemistry', performance: '79%', hoursStudied: '8.1h' }
                ],
                achievements: [
                    { title: 'Study Marathon', description: 'Studied 5 hours straight', date: 'Today' },
                    { title: 'Perfect Week', description: 'Met all daily goals', date: 'Yesterday' },
                    { title: 'Knowledge Seeker', description: 'Completed 50 tasks', date: '2 days ago' }
                ]
            };

            const dataStr = JSON.stringify(studyData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `study-analytics-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            
            showNotification('Study data exported successfully!', 'success');
        }

        function showTaskModal() {
            
            const taskModal = document.getElementById('taskModal');
            if (taskModal) {
                taskModal.style.display = 'flex';
                taskModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
                
                const taskForm = document.getElementById('taskForm');
                if (taskForm) {
                    taskForm.reset();
                }
                
                showNotification('Task creator opened', 'info');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <i class="fa-solid fa-check-circle"></i>
                <span>${message}</span>
            `;

            const notificationStyles = `
                <style>
                .notification {
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(74, 222, 128, 0.9);
                    color: white;
                    padding: 15px 20px;
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    z-index: 10001;
                    backdrop-filter: blur(10px);
                    animation: slideInNotification 0.3s ease;
                }
                @keyframes slideInNotification {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                </style>
            `;

            if (!document.querySelector('style[data-notification-styles]')) {
                const styleEl = document.createElement('style');
                styleEl.setAttribute('data-notification-styles', 'true');
                styleEl.textContent = notificationStyles.replace(/<\/?style>/g, '');
                document.head.appendChild(styleEl);
            }

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideInNotification 0.3s ease reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        
        function deleteTask(button) {
            const taskItem = button.closest('.task-item');
            const taskTitle = taskItem.querySelector('.task-title').textContent;
            
            
            if (confirm(`Are you sure you want to delete "${taskTitle}"?`)) {
                
                taskItem.style.transition = 'all 0.3s ease';
                taskItem.style.opacity = '0';
                taskItem.style.transform = 'translateX(-100%)';
                
                
                setTimeout(() => {
                    taskItem.remove();
                    updateTaskCounter();
                    showNotification(`Task "${taskTitle}" deleted successfully!`, 'success');
                }, 300);
            }
        }

        function updateTaskCounter() {
            const allTasks = document.querySelectorAll('.task-item').length;
            const completedTasks = document.querySelectorAll('.task-item.completed').length;
            const remainingTasks = allTasks - completedTasks;
            const completionPercentage = allTasks > 0 ? Math.round((completedTasks / allTasks) * 100) : 0;
            
            
            const tasksCount = document.querySelector('.tasks-count');
            const tasksProgress = document.querySelector('.tasks-progress');
            
            if (tasksCount) {
                tasksCount.textContent = `${remainingTasks} of ${allTasks} tasks remaining`;
            }
            
            if (tasksProgress) {
                tasksProgress.textContent = `${completionPercentage}% completed today`;
            }
        }

        function toggleTaskCompletion(checkbox) {
            const taskItem = checkbox.closest('.task-item');
            const taskCheckbox = taskItem.querySelector('.task-checkbox');
            
            if (taskItem.classList.contains('completed')) {
                
                taskItem.classList.remove('completed');
                taskCheckbox.innerHTML = '<div class="checkbox-circle"></div>';
            } else {
                
                taskItem.classList.add('completed');
                taskCheckbox.innerHTML = '<i class="fa-solid fa-check"></i>';
            }
            
            updateTaskCounter();
        }

        
        document.addEventListener('DOMContentLoaded', function() {
            const checkboxes = document.querySelectorAll('.task-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    toggleTaskCompletion(this);
                });
            });
            
            
            updateTaskCounter();
        });

        function showInteractiveTaskCreator() {
            try {
                
                showEnhancedTaskModal();
            } catch (error) {
                console.error('Error showing task modal:', error);
                
                const title = prompt('Enter task title:');
                if (title) {
                    const time = prompt('Enter time (optional):');
                    const priority = prompt('Enter priority (High/Medium/Low):') || 'Medium';
                    showNotification(`Task "${title}" would be created with ${priority} priority${time ? ' at ' + time : ''}`, 'success');
                }
            }
        }

        function showEnhancedTaskModal() {
            
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'enhanced-task-modal-overlay';
            modalOverlay.innerHTML = `
                <div class="enhanced-task-modal">
                    <div class="modal-header">
                        <h2><i class="fa-solid fa-magic"></i> Create New Task</h2>
                        <button class="modal-close-btn" onclick="closeEnhancedTaskModal()">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-content">
                        <div class="task-form-container">
                            <div class="form-group">
                                <label for="taskTitleInput">
                                    <i class="fa-solid fa-pen"></i> Task Title
                                </label>
                                <input type="text" id="taskTitleInput" placeholder="What needs to be done?" maxlength="100" autocomplete="off">
                                <div class="input-suggestions" id="titleSuggestions"></div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="taskTimeInput">
                                        <i class="fa-solid fa-clock"></i> Time
                                    </label>
                                    <input type="time" id="taskTimeInput">
                                </div>
                                
                                <div class="form-group">
                                    <label for="taskPrioritySelect">
                                        <i class="fa-solid fa-flag"></i> Priority
                                    </label>
                                    <select id="taskPrioritySelect">
                                        <option value="Low"> Low Priority</option>
                                        <option value="Medium" selected> Medium Priority</option>
                                        <option value="High"> High Priority</option>
                                        <option value="Urgent"> Urgent</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="taskCategorySelect">
                                    <i class="fa-solid fa-tags"></i> Category
                                </label>
                                <select id="taskCategorySelect">
                                    <option value="Study"> Study</option>
                                    <option value="Assignment"> Assignment</option>
                                    <option value="Project"> Project</option>
                                    <option value="Meeting"> Meeting</option>
                                    <option value="Exam"> Exam</option>
                                    <option value="Personal"> Personal</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="taskNotesInput">
                                    <i class="fa-solid fa-sticky-note"></i> Notes (Optional)
                                </label>
                                <textarea id="taskNotesInput" placeholder="Add any additional details..." rows="3" maxlength="200"></textarea>
                            </div>
                            
                            <div class="smart-suggestions">
                                <h4><i class="fa-solid fa-lightbulb"></i> Smart Suggestions</h4>
                                <div class="suggestion-chips">
                                    <span class="suggestion-chip" onclick="applySuggestion('Complete Math Homework')"> Complete Math Homework</span>
                                    <span class="suggestion-chip" onclick="applySuggestion('Read Chapter 5')"> Read Chapter 5</span>
                                    <span class="suggestion-chip" onclick="applySuggestion('Prepare Presentation')"> Prepare Presentation</span>
                                    <span class="suggestion-chip" onclick="applySuggestion('Study for Test')"> Study for Test</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="btn-cancel" onclick="closeEnhancedTaskModal()">
                            <i class="fa-solid fa-times"></i> Cancel
                        </button>
                        <button class="btn-create-task" onclick="createEnhancedTask()">
                            <i class="fa-solid fa-plus"></i> Create Task
                        </button>
                    </div>
                </div>
            `;
            
            
            const modalStyles = document.createElement('style');
            modalStyles.textContent = getEnhancedModalStyles();
            document.head.appendChild(modalStyles);
            
            document.body.appendChild(modalOverlay);
            
            
            document.body.style.overflow = 'hidden';
            
            
            setTimeout(() => {
                modalOverlay.classList.add('active');
                const titleInput = document.getElementById('taskTitleInput');
                if (titleInput) {
                    titleInput.focus();
                }
            }, 10);
            
            
            const now = new Date();
            document.getElementById('taskTimeInput').value = now.toTimeString().slice(0,5);
        }

        function addNewTask() {
            showInteractiveTaskCreator();
            
            if (taskTitle && taskTime) {
                const tasksList = document.querySelector('.tasks-list');
                const newTask = document.createElement('div');
                newTask.className = 'task-item';
                
                
                let priorityClass = '';
                if (taskPriority.toLowerCase() === 'high') priorityClass = 'urgent';
                if (priorityClass) newTask.classList.add(priorityClass);
                
                newTask.innerHTML = `
                    <div class="task-checkbox">
                        <div class="checkbox-circle"></div>
                    </div>
                    <div class="task-content">
                        <span class="task-title">${taskTitle}</span>
                        <span class="task-meta">
                            <i class="fa-solid fa-clock"></i> ${taskTime}
                            <i class="fa-solid fa-flag"></i> ${taskPriority} Priority
                        </span>
                    </div>
                    <div class="task-actions">
                        <button class="task-edit"><i class="fa-solid fa-edit"></i></button>
                        <button class="task-delete" onclick="deleteTask(this)"><i class="fa-solid fa-times"></i></button>
                    </div>
                `;
                
                
                const newCheckbox = newTask.querySelector('.task-checkbox');
                newCheckbox.addEventListener('click', function() {
                    toggleTaskCompletion(this);
                });
                
                
                newTask.style.opacity = '0';
                newTask.style.transform = 'translateX(-100%)';
                tasksList.appendChild(newTask);
                
                setTimeout(() => {
                    newTask.style.transition = 'all 0.3s ease';
                    newTask.style.opacity = '1';
                    newTask.style.transform = 'translateX(0)';
                    updateTaskCounter();
                    showNotification(`Task "${taskTitle}" added successfully!`, 'success');
                }, 10);
            }
        }

        function getEnhancedModalStyles() {
            return `
                .enhanced-task-modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    width: 100vw;
                    height: 100vh;
                    background: rgba(0, 0, 0, 0.8);
                    backdrop-filter: blur(10px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    opacity: 0;
                    visibility: hidden;
                    transition: all 0.3s ease;
                    padding: 20px;
                    box-sizing: border-box;
                }

                .enhanced-task-modal-overlay.active {
                    opacity: 1;
                    visibility: visible;
                }

                .enhanced-task-modal {
                    background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
                    border-radius: 20px;
                    width: 100%;
                    max-width: 600px;
                    max-height: 90vh;
                    overflow-y: auto;
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
                    margin: auto;
                    position: relative;
                    transform: scale(0.95) translateY(20px);
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                }

                .enhanced-task-modal-overlay.active .enhanced-task-modal {
                    transform: scale(1) translateY(0);
                }

                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 25px 30px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                }

                .modal-header h2 {
                    color: white;
                    font-size: 24px;
                    font-weight: 600;
                    margin: 0;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }

                .modal-close-btn {
                    background: rgba(255, 255, 255, 0.1);
                    border: none;
                    color: white;
                    width: 40px;
                    height: 40px;
                    border-radius: 50%;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                }

                .modal-close-btn:hover {
                    background: rgba(255, 107, 107, 0.2);
                    color: #ff6b6b;
                    transform: rotate(90deg);
                }

                .modal-content {
                    padding: 30px;
                }

                .task-form-container .form-group {
                    margin-bottom: 25px;
                }

                .task-form-container label {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    color: #e2e8f0;
                    font-weight: 500;
                    margin-bottom: 8px;
                    font-size: 14px;
                }

                .task-form-container input,
                .task-form-container select,
                .task-form-container textarea {
                    width: 100%;
                    padding: 12px 16px;
                    background: rgba(255, 255, 255, 0.05);
                    border: 2px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    color: white;
                    font-size: 14px;
                    transition: all 0.3s ease;
                    box-sizing: border-box;
                }

                .task-form-container input:focus,
                .task-form-container select:focus,
                .task-form-container textarea:focus {
                    outline: none;
                    border-color: #667eea;
                    background: rgba(255, 255, 255, 0.08);
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                }

                .form-row {
                    display: flex;
                    gap: 20px;
                }

                .form-row .form-group {
                    flex: 1;
                }

                .smart-suggestions {
                    margin-top: 20px;
                    padding: 20px;
                    background: rgba(255, 255, 255, 0.03);
                    border-radius: 12px;
                    border: 1px solid rgba(255, 255, 255, 0.05);
                }

                .smart-suggestions h4 {
                    color: #e2e8f0;
                    font-size: 16px;
                    margin: 0 0 15px 0;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .suggestion-chips {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 10px;
                }

                .suggestion-chip {
                    background: rgba(102, 126, 234, 0.2);
                    color: #a7b6f7;
                    padding: 8px 15px;
                    border-radius: 20px;
                    cursor: pointer;
                    font-size: 13px;
                    transition: all 0.3s ease;
                    border: 1px solid rgba(102, 126, 234, 0.3);
                }

                .suggestion-chip:hover {
                    background: rgba(102, 126, 234, 0.4);
                    color: white;
                    transform: translateY(-2px);
                }

                .modal-actions {
                    display: flex;
                    justify-content: flex-end;
                    gap: 15px;
                    padding: 25px 30px;
                    border-top: 1px solid rgba(255, 255, 255, 0.1);
                }

                .btn-cancel,
                .btn-create-task {
                    padding: 12px 25px;
                    border-radius: 10px;
                    font-size: 14px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    border: none;
                }

                .btn-cancel {
                    background: rgba(255, 255, 255, 0.1);
                    color: #e2e8f0;
                    border: 1px solid rgba(255, 255, 255, 0.2);
                }

                .btn-cancel:hover {
                    background: rgba(255, 255, 255, 0.15);
                    transform: translateY(-2px);
                }

                .btn-create-task {
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    color: white;
                    min-width: 140px;
                    justify-content: center;
                }

                .btn-create-task:hover {
                    background: linear-gradient(135deg, #5a6fd8, #6a4190);
                    transform: translateY(-2px);
                    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
                }

                @media (max-width: 768px) {
                    
                    .enhanced-task-modal {
                        width: 95% !important;
                        max-width: 400px !important;
                        margin: 0 auto !important;
                        max-height: 85vh !important;
                        overflow-y: auto;
                        padding: 15px;
                        position: relative;
                        border-radius: 12px;
                        transform: scale(0.98) translateY(10px) !important;
                    }

                    .modal-header {
                        padding: 15px 0 20px 0;
                        text-align: center;
                    }

                    .modal-header h2 {
                        font-size: 20px;
                    }

                    .close-modal-btn {
                        width: 35px;
                        height: 35px;
                        font-size: 18px;
                    }

                    
                    .task-form-group {
                        margin-bottom: 20px;
                    }

                    .task-form-group label {
                        font-size: 14px;
                        margin-bottom: 8px;
                    }

                    .task-form-group input,
                    .task-form-group textarea,
                    .task-form-group select {
                        font-size: 16px; 
                        padding: 12px 15px;
                        border-radius: 8px;
                    }

                    .task-form-group textarea {
                        min-height: 80px;
                        resize: vertical;
                    }

                    .form-row {
                        flex-direction: column;
                        gap: 0;
                    }

                    
                    .priority-chips,
                    .category-chips {
                        flex-wrap: wrap;
                        gap: 8px;
                    }

                    .priority-chip,
                    .category-chip {
                        padding: 8px 12px;
                        font-size: 13px;
                        min-width: 70px;
                        text-align: center;
                    }

                    
                    .suggestion-chips {
                        flex-wrap: wrap;
                        gap: 6px;
                        max-height: 100px;
                        overflow-y: auto;
                    }

                    .suggestion-chip {
                        padding: 6px 10px;
                        font-size: 12px;
                    }

                    
                    .modal-actions {
                        flex-direction: column;
                        gap: 12px;
                        margin-top: 25px;
                        padding: 20px 0 10px 0;
                        border-top: 1px solid rgba(255, 255, 255, 0.1);
                        position: sticky;
                        bottom: 0;
                        background: inherit;
                        backdrop-filter: blur(10px);
                    }

                    .btn-cancel,
                    .btn-create-task {
                        width: 100%;
                        padding: 14px 20px;
                        font-size: 16px;
                        border-radius: 8px;
                        min-height: 48px; 
                    }

                    
                    .enhanced-task-modal-overlay.active .enhanced-task-modal {
                        transform: translateY(0) scale(1);
                        animation: modalSlideUp 0.3s ease-out;
                    }

                    @keyframes modalSlideUp {
                        from {
                            transform: translateY(20px) scale(0.95);
                            opacity: 0;
                        }
                        to {
                            transform: translateY(0) scale(1);
                            opacity: 1;
                        }
                    }

                    
                    .enhanced-task-modal-overlay {
                        padding: 10px;
                        overflow-y: auto;
                        -webkit-overflow-scrolling: touch;
                        display: flex !important;
                        align-items: center !important;
                        justify-content: center !important;
                        width: 100vw !important;
                        height: 100vh !important;
                        position: fixed !important;
                        top: 0 !important;
                        left: 0 !important;
                        right: 0 !important;
                        bottom: 0 !important;
                    }

                    
                    .enhanced-task-modal .task-form-container {
                        max-height: 70vh;
                        overflow-y: auto;
                        -webkit-overflow-scrolling: touch;
                        padding-right: 5px;
                    }

                    
                    .enhanced-task-modal::-webkit-scrollbar {
                        width: 4px;
                    }

                    .enhanced-task-modal::-webkit-scrollbar-track {
                        background: rgba(255, 255, 255, 0.1);
                        border-radius: 2px;
                    }

                    .enhanced-task-modal::-webkit-scrollbar-thumb {
                        background: rgba(255, 255, 255, 0.3);
                        border-radius: 2px;
                    }

                    
                    .form-error {
                        font-size: 12px;
                        margin-top: 5px;
                    }

                    
                    input[type="time"],
                    input[type="date"] {
                        font-size: 16px;
                        padding: 12px;
                    }
                        justify-content: center;
                    }
                }
            `;
        }

        function applySuggestion(suggestion) {
            document.getElementById('taskTitleInput').value = suggestion;
            
            
            const chip = event.target;
            chip.style.background = 'rgba(16, 185, 129, 0.4)';
            chip.style.color = 'white';
            setTimeout(() => {
                chip.style.background = 'rgba(102, 126, 234, 0.2)';
                chip.style.color = '#a7b6f7';
            }, 500);
        }

        function closeEnhancedTaskModal() {
            const modal = document.querySelector('.enhanced-task-modal-overlay');
            if (modal) {
                modal.classList.remove('active');
                
                document.body.style.overflow = '';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }

        function createEnhancedTask() {
            const title = document.getElementById('taskTitleInput').value.trim();
            const time = document.getElementById('taskTimeInput').value;
            const priority = document.getElementById('taskPrioritySelect').value;
            const category = document.getElementById('taskCategorySelect').value;
            const notes = document.getElementById('taskNotesInput').value.trim();

            if (!title) {
                showNotification('Please enter a task title!', 'error');
                return;
            }

            
            let tasksList = document.querySelector('.sample-tasks-section .tasks-list');
            if (!tasksList) {
                
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    const tasksSection = document.createElement('div');
                    tasksSection.className = 'sample-tasks-section';
                    tasksSection.innerHTML = `
                        <div class="tasks-header">
                            <h4><i class="fa-solid fa-list-check"></i> My Tasks</h4>
                        </div>
                        <div class="tasks-list"></div>
                        <div class="tasks-summary">
                            <span class="tasks-count">0 tasks</span>
                            <span class="tasks-progress">0% completed</span>
                        </div>
                    `;
                    mainContent.appendChild(tasksSection);
                    tasksList = tasksSection.querySelector('.tasks-list');
                }
            }

            if (!tasksList) {
                showNotification(`Task Created Successfully! Title: ${title}, Priority: ${priority}`, 'success');
                closeEnhancedTaskModal();
                return;
            }

            const newTask = document.createElement('div');
            newTask.className = 'task-item';
            
            
            if (priority === 'High' || priority === 'Urgent') {
                newTask.classList.add('urgent');
            }
            
            
            const timeDisplay = time ? formatTime(time) : getCurrentTime();
            
            
            const priorityInfo = getPriorityInfo(priority);
            const categoryEmoji = getCategoryEmoji(category);
            
            newTask.innerHTML = `
                <div class="task-checkbox" onclick="toggleTaskCompletion(this)">
                    <div class="checkbox-circle"></div>
                </div>
                <div class="task-content">
                    <span class="task-title">${categoryEmoji} ${title}</span>
                    <span class="task-meta">
                        <i class="fa-solid fa-clock"></i> ${timeDisplay}
                        <span class="priority-badge priority-${priority.toLowerCase()}">${priorityInfo.emoji} ${priority} Priority</span>
                        <i class="fa-solid fa-tag"></i> ${category}
                        ${notes ? '<i class="fa-solid fa-sticky-note" title="' + notes + '" style="color: #fbbf24;"></i>' : ''}
                    </span>
                </div>
                <div class="task-actions">
                    <button class="task-edit" title="Edit task"><i class="fa-solid fa-edit"></i></button>
                    <button class="task-delete" onclick="deleteTask(this)" title="Delete task"><i class="fa-solid fa-times"></i></button>
                </div>
            `;
            
            
            newTask.style.cssText = `
                opacity: 0;
                transform: translateY(20px) scale(0.9);
                transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                border-left: 4px solid ${priorityInfo.color};
                background: linear-gradient(90deg, ${priorityInfo.color}15, transparent);
            `;
            
            
            addTaskDisplayStyles();
            
            
            if (tasksList.firstChild) {
                tasksList.insertBefore(newTask, tasksList.firstChild);
            } else {
                tasksList.appendChild(newTask);
            }
            
            
            setTimeout(() => {
                newTask.style.opacity = '1';
                newTask.style.transform = 'translateY(0) scale(1)';
            }, 50);
            
            
            setTimeout(() => {
                newTask.style.background = 'rgba(102, 126, 234, 0.2)';
                setTimeout(() => {
                    newTask.style.background = `linear-gradient(90deg, ${getPriorityInfo(priority).color}15, transparent)`;
                }, 1000);
            }, 500);

            
            storeTaskData({
                id: Date.now(),
                title,
                time,
                priority,
                category,
                notes,
                completed: false,
                created: new Date().toISOString()
            });

            
            closeEnhancedTaskModal();
            updateTaskCounter();
            
            
            showNotification(` Task Created: "${title}" | ${priority} Priority | ${category}`, 'success');
            
            
            newTask.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function formatTime(time24) {
            const [hours, minutes] = time24.split(':');
            const hour12 = hours % 12 || 12;
            const ampm = hours >= 12 ? 'PM' : 'AM';
            return `${hour12}:${minutes} ${ampm}`;
        }

        function getCurrentTime() {
            const now = new Date();
            return now.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
        }

        function getPriorityInfo(priority) {
            const priorities = {
                'Low': { emoji: '', color: '#10b981' },
                'Medium': { emoji: '', color: '#f59e0b' },
                'High': { emoji: '', color: '#ef4444' },
                'Urgent': { emoji: '', color: '#dc2626' }
            };
            return priorities[priority] || priorities['Medium'];
        }

        function getCategoryEmoji(category) {
            const categories = {
                'Study': '',
                'Assignment': '',
                'Project': '',
                'Meeting': '',
                'Exam': '',
                'Personal': ''
            };
            return categories[category] || '';
        }

        function addTaskDisplayStyles() {
            if (document.getElementById('task-display-styles')) return;
            
            const styles = document.createElement('style');
            styles.id = 'task-display-styles';
            styles.textContent = `
                .priority-badge {
                    padding: 2px 8px;
                    border-radius: 12px;
                    font-size: 11px;
                    font-weight: 600;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                    margin: 0 5px;
                }
                
                .priority-low {
                    background: rgba(16, 185, 129, 0.2);
                    color: #10b981;
                    border: 1px solid rgba(16, 185, 129, 0.3);
                }
                
                .priority-medium {
                    background: rgba(245, 158, 11, 0.2);
                    color: #f59e0b;
                    border: 1px solid rgba(245, 158, 11, 0.3);
                }
                
                .priority-high {
                    background: rgba(239, 68, 68, 0.2);
                    color: #ef4444;
                    border: 1px solid rgba(239, 68, 68, 0.3);
                }
                
                .priority-urgent {
                    background: rgba(220, 38, 38, 0.3);
                    color: #dc2626;
                    border: 1px solid rgba(220, 38, 38, 0.4);
                    animation: urgentPulse 2s ease-in-out infinite;
                }
                
                @keyframes urgentPulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                }
                
                .task-item {
                    transition: all 0.3s ease;
                }
                
                .task-item:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                }
                
                .task-content {
                    flex: 1;
                }
                
                .task-title {
                    font-size: 14px;
                    font-weight: 600;
                    color: white;
                    display: block;
                    margin-bottom: 5px;
                }
                
                .task-meta {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 12px;
                    color: rgba(255, 255, 255, 0.7);
                    flex-wrap: wrap;
                }
                
                .task-actions {
                    display: flex;
                    gap: 5px;
                    opacity: 0.7;
                    transition: opacity 0.3s ease;
                }
                
                .task-item:hover .task-actions {
                    opacity: 1;
                }
            `;
            
            document.head.appendChild(styles);
        }

        
        function storeTaskData(taskData) {
            try {
                const existingTasks = JSON.parse(localStorage.getItem('studyBuddyTasks') || '[]');
                existingTasks.unshift(taskData); 
                localStorage.setItem('studyBuddyTasks', JSON.stringify(existingTasks));
            } catch (e) {
                
            }
        }

        function updateTaskCounter() {
            const tasksList = document.getElementById('tasks-list') || document.querySelector('.task-card ul, .task-card ol');
            if (tasksList) {
                const taskCount = tasksList.children.length;
                const counterElement = document.querySelector('.task-counter');
                
                if (counterElement) {
                    counterElement.textContent = `${taskCount} task${taskCount !== 1 ? 's' : ''}`;
                } else {
                    
                    const taskCard = document.querySelector('.task-card h3');
                    if (taskCard) {
                        const counter = document.createElement('span');
                        counter.className = 'task-counter';
                        counter.style.cssText = `
                            color: #667eea;
                            font-size: 0.9rem;
                            font-weight: normal;
                            margin-left: 8px;
                            padding: 2px 8px;
                            background: rgba(102, 126, 234, 0.1);
                            border-radius: 12px;
                        `;
                        counter.textContent = `${taskCount} task${taskCount !== 1 ? 's' : ''}`;
                        taskCard.appendChild(counter);
                    }
                }
            }
        }

        function toggleTaskCompletion(taskElement, checkbox) {
            const taskContent = taskElement.querySelector('.task-content');
            if (checkbox.checked) {
                taskContent.classList.add('task-completed');
                taskElement.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    taskElement.style.transform = 'scale(1)';
                }, 200);
            } else {
                taskContent.classList.remove('task-completed');
                taskElement.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    taskElement.style.transform = 'scale(1)';
                }, 200);
            }
        }

        function deleteTaskWithConfirmation(taskElement, taskTitle) {
            if (confirm(`Are you sure you want to delete the task: "${taskTitle}"?`)) {
                
                taskElement.style.transition = 'all 0.3s ease';
                taskElement.style.opacity = '0';
                taskElement.style.transform = 'translateX(-100%)';
                
                setTimeout(() => {
                    taskElement.remove();
                    updateTaskCounter();
                    showNotification(`Task "${taskTitle}" deleted successfully! `, 'info');
                }, 300);
            }
        }

        
        function startPomodoroTimer() {
            showNotification(' Pomodoro Timer: 25 minutes of focused study time started!', 'success');
            
        }

        function openQuickNotes() {
            const notes = prompt(' Quick Notes:\n\nWrite your thoughts, ideas, or reminders here:');
            if (notes) {
                showNotification(' Notes saved successfully!', 'success');
                
            }
        }

        function openCalculator() {
            const calculation = prompt(' Calculator:\n\nEnter a mathematical expression (e.g., 2+2, 10*5, sqrt(16)):');
            if (calculation) {
                try {
                    
                    const result = Function('"use strict"; return (' + calculation.replace(/[^0-9+\-*/.() ]/g, '') + ')')();
                    showNotification(` Result: ${calculation} = ${result}`, 'success');
                } catch (e) {
                    showNotification(' Invalid mathematical expression', 'error');
                }
            }
        }

        function openFlashcards() {
            showNotification(' Flashcards: Feature coming soon! Create digital flashcards for quick review.', 'info');
        }

        function refreshQuote() {
            const quotes = [
                {text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill"},
                {text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney"},
                {text: "Innovation distinguishes between a leader and a follower.", author: "Steve Jobs"},
                {text: "Life is what happens to you while you're busy making other plans.", author: "John Lennon"},
                {text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt"},
                {text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson"},
                {text: "Education is the most powerful weapon which you can use to change the world.", author: "Nelson Mandela"},
                {text: "The only way to do great work is to love what you do.", author: "Steve Jobs"}
            ];
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('motivationQuote').textContent = `"${randomQuote.text}"`;
            document.getElementById('quoteAuthor').textContent = `- ${randomQuote.author}`;
            
            showNotification(' New motivation loaded!', 'success');
        }

        function updateDateTime() {
            const now = new Date();
            const timeOptions = { 
                hour: 'numeric', 
                minute: '2-digit', 
                hour12: true 
            };
            const dateOptions = { 
                weekday: 'long', 
                month: 'short', 
                day: 'numeric' 
            };
            
            const timeElement = document.getElementById('currentTime');
            const dateElement = document.getElementById('currentDate');
            const tipElement = document.getElementById('studyTip');
            
            if (timeElement) {
                timeElement.textContent = now.toLocaleTimeString('en-US', timeOptions);
            }
            if (dateElement) {
                dateElement.textContent = now.toLocaleDateString('en-US', dateOptions);
            }
            
            
            if (tipElement) {
                const hour = now.getHours();
                let tip = "Perfect time for a focused study session!";
                
                if (hour >= 6 && hour < 12) {
                    tip = " Morning energy! Great time for challenging topics.";
                } else if (hour >= 12 && hour < 17) {
                    tip = " Afternoon focus! Time for review and practice.";
                } else if (hour >= 17 && hour < 21) {
                    tip = " Evening study! Perfect for reading and notes.";
                } else {
                    tip = " Late night? Consider a break and some rest.";
                }
                
                tipElement.textContent = tip;
            }
        }

        
        function isMobile() {
            return window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        function optimizeForMobile() {
            if (isMobile()) {
                
                const sparkles = document.querySelectorAll('.btn-sparkles');
                sparkles.forEach(sparkle => {
                    sparkle.style.display = 'none';
                });

                
                document.body.classList.add('mobile-device');

                
                const modalOverlay = document.querySelector('.enhanced-task-modal-overlay');
                if (modalOverlay) {
                    modalOverlay.addEventListener('touchstart', function(e) {
                        if (e.target === modalOverlay) {
                            closeEnhancedTaskModal();
                        }
                    });
                }

                
                const interactiveElements = document.querySelectorAll('.interactive-add-task-btn, .quick-btn, .task-edit, .task-delete');
                interactiveElements.forEach(element => {
                    element.addEventListener('touchstart', function() {
                        this.style.transform = 'scale(0.95)';
                    });
                    
                    element.addEventListener('touchend', function() {
                        setTimeout(() => {
                            this.style.transform = '';
                        }, 150);
                    });
                });

                
                const inputs = document.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        
                        let viewport = document.querySelector('meta[name="viewport"]');
                        if (!viewport) {
                            viewport = document.createElement('meta');
                            viewport.name = 'viewport';
                            document.head.appendChild(viewport);
                        }
                        viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0';
                    });
                    
                    input.addEventListener('blur', function() {
                        let viewport = document.querySelector('meta[name="viewport"]');
                        if (viewport) {
                            viewport.content = 'width=device-width, initial-scale=1.0';
                        }
                    });
                });

                
                const quickInput = document.getElementById('quickTaskInput');
                if (quickInput) {
                    quickInput.addEventListener('focus', function() {
                        
                        setTimeout(() => {
                            this.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }, 300);
                    });
                }

                
                function adjustModalForMobile() {
                    const modalOverlay = document.querySelector('.enhanced-task-modal-overlay');
                    const modal = document.querySelector('.enhanced-task-modal');
                    
                    if (modalOverlay && modal) {
                        
                        modalOverlay.style.position = 'fixed';
                        modalOverlay.style.top = '0';
                        modalOverlay.style.left = '0';
                        modalOverlay.style.right = '0';
                        modalOverlay.style.bottom = '0';
                        modalOverlay.style.width = '100vw';
                        modalOverlay.style.height = '100vh';
                        modalOverlay.style.display = 'flex';
                        modalOverlay.style.alignItems = 'center';
                        modalOverlay.style.justifyContent = 'center';
                        modalOverlay.style.margin = '0';
                        modalOverlay.style.padding = '10px';
                        
                        
                        const viewportHeight = window.innerHeight;
                        const maxModalHeight = Math.min(viewportHeight * 0.85, 600);
                        modal.style.maxHeight = maxModalHeight + 'px';
                        modal.style.width = '95%';
                        modal.style.maxWidth = '400px';
                        modal.style.margin = '0 auto';
                        
                        
                        const modalActions = modal.querySelector('.modal-actions');
                        if (modalActions) {
                            modalActions.style.position = 'sticky';
                            modalActions.style.bottom = '0';
                        }
                    }
                }

                
                function ensureModalCentered() {
                    const modalOverlay = document.querySelector('.enhanced-task-modal-overlay');
                    if (modalOverlay) {
                        
                        modalOverlay.offsetHeight; 
                        
                        if (isMobile()) {
                            adjustModalForMobile();
                        }
                        
                        
                        setTimeout(() => {
                            modalOverlay.style.display = 'flex';
                            modalOverlay.style.alignItems = 'center';
                            modalOverlay.style.justifyContent = 'center';
                        }, 10);
                    }
                }

                
                const originalShowModal = window.showInteractiveTaskCreator;
                if (originalShowModal) {
                    window.showInteractiveTaskCreator = function() {
                        originalShowModal();
                        ensureModalCentered();
                    };
                }

                
                window.addEventListener('load', function() {
                    if (typeof showInteractiveTaskCreator === 'function') {
                        const originalFunction = showInteractiveTaskCreator;
                        window.showInteractiveTaskCreator = function() {
                            originalFunction();
                            ensureModalCentered();
                        };
                    }
                });

                
                window.addEventListener('resize', function() {
                    if (isMobile()) {
                        adjustModalForMobile();
                    }
                });
            }
        }

        
        document.addEventListener('DOMContentLoaded', function() {
            updateTaskCounter(); 
            updateDateTime(); 
            optimizeForMobile(); 
            
            
            setInterval(updateDateTime, 60000);
            
            
            const bonusButtons = document.querySelectorAll('.bonus-btn, .quick-link');
            bonusButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });

            
            window.addEventListener('orientationchange', function() {
                if (isMobile()) {
                    setTimeout(() => {
                        optimizeForMobile();
                    }, 500);
                }
            });

            
            window.addEventListener('resize', function() {
                if (isMobile()) {
                    optimizeForMobile();
                }
            });
        });
    </script>
</body>
</html>


